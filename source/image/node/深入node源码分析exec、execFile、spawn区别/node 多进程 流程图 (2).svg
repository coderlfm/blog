<?xml version="1.0" standalone="no"?>
<svg style="background: #FFFFFF;padding:20px" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="4814px" height="2133px" viewBox="-0.5 -0.5 4794 1933"><defs><style>* {margin: 0px; padding: 0px;}</style></defs><g><path d="M 2319 25.5 L 2751 25.5 L 2751 629.5 L 2319 629.5 L 2319 25.5 Z" fill="none" stroke="#999999" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="none"/><path d="M 3253.07 227.5 L 4107.07 227.5 L 4107.07 838.5 L 3253.07 838.5 L 3253.07 227.5 Z" fill="none" stroke="#999999" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="none"/><path d="M 249 25.5 L 322.63 25.5" fill="none" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><path d="M 327.88 25.5 L 320.88 29 L 322.63 25.5 L 320.88 22 Z" fill="#4d4d4d" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><path d="M 149 50.5 L 149 124.13" fill="none" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><path d="M 149 129.38 L 145.5 122.38 L 149 124.13 L 152.5 122.38 Z" fill="#4d4d4d" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><path d="M 49 0.5 L 249 0.5 L 249 50.5 L 49 50.5 L 49 0.5 Z" fill="#ffffff" stroke="none" pointer-events="none"/><path d="M 57.33 4.67 L 57.33 46.33 L 57.33 46.33 L 240.67 46.33 L 240.67 4.67 L 57.33 4.67" fill="#ffffff" stroke="none" pointer-events="none"/><path d="M 49 0.5 L 249 0.5 L 249 50.5 L 49 50.5 L 49 0.5 Z" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="12px"><text x="147.79" y="28.29">exec(command, options, callback)</text></g><path d="M 259 155.5 L 323.13 155.5" fill="none" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><path d="M 328.38 155.5 L 321.38 159 L 323.13 155.5 L 321.38 152 Z" fill="#4d4d4d" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><path d="M 39 130.5 L 259 130.5 L 259 180.5 L 39 180.5 L 39 130.5 Z" fill="#ffffff" stroke="none" pointer-events="none"/><path d="M 48.17 134.67 L 48.17 176.33 L 48.17 176.33 L 249.83 176.33 L 249.83 134.67 L 48.17 134.67" fill="#ffffff" stroke="none" pointer-events="none"/><path d="M 39 130.5 L 259 130.5 L 259 180.5 L 39 180.5 L 39 130.5 Z" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="12px"><text x="147.79" y="144.29">  return module.exports.execFile(opts.file,</text><text x="147.79" y="158.29">                                 opts.options,</text><text x="147.79" y="172.29">                                 opts.callback);</text></g><path d="M 440.14 180.5 L 440.14 201.29 L 440.14 214.13" fill="none" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><path d="M 440.14 219.38 L 436.64 212.38 L 440.14 214.13 L 443.64 212.38 Z" fill="#4d4d4d" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><path d="M 329.5 130.5 L 549.5 130.5 L 549.5 180.5 L 329.5 180.5 L 329.5 130.5 Z" fill="#ffffff" stroke="none" pointer-events="none"/><path d="M 338.67 134.67 L 338.67 176.33 L 338.67 176.33 L 540.33 176.33 L 540.33 134.67 L 338.67 134.67" fill="#ffffff" stroke="none" pointer-events="none"/><path d="M 329.5 130.5 L 549.5 130.5 L 549.5 180.5 L 329.5 180.5 L 329.5 130.5 Z" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="12px"><text x="438.29" y="151.29">接受第一个参数，</text><text x="438.29" y="165.29">且做一系列 normalizeExecArgs</text></g><path d="M 439.5 260.5 L 439.5 294.13" fill="none" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><path d="M 439.5 299.38 L 436 292.38 L 439.5 294.13 L 443 292.38 Z" fill="#4d4d4d" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><path d="M 389 220.5 L 490 220.5 L 490 260.5 L 389 260.5 L 389 220.5 Z" fill="#ffffff" stroke="none" pointer-events="none"/><path d="M 393.21 223.83 L 393.21 257.17 L 393.21 257.17 L 485.79 257.17 L 485.79 223.83 L 393.21 223.83" fill="#ffffff" stroke="none" pointer-events="none"/><path d="M 389 220.5 L 490 220.5 L 490 260.5 L 389 260.5 L 389 220.5 Z" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="12px"><text x="438.29" y="243.29">生成 options</text></g><path d="M 439.5 340.5 L 439.5 417.63" fill="none" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><path d="M 439.5 422.88 L 436 415.88 L 439.5 417.63 L 443 415.88 Z" fill="#4d4d4d" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><path d="M 389 300.5 L 490 300.5 L 490 340.5 L 389 340.5 L 389 300.5 Z" fill="#ffffff" stroke="none" pointer-events="none"/><path d="M 393.21 303.83 L 393.21 337.17 L 393.21 337.17 L 485.79 337.17 L 485.79 303.83 L 393.21 303.83" fill="#ffffff" stroke="none" pointer-events="none"/><path d="M 389 300.5 L 490 300.5 L 490 340.5 L 389 340.5 L 389 300.5 Z" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="12px"><text x="438.29" y="323.29">一系列验证</text></g><path d="M 500 444.14 Q 671.57 444.14 840.92 444.14" fill="none" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><path d="M 846.17 444.14 L 839.17 447.64 L 840.92 444.14 L 839.17 440.64 Z" fill="#4d4d4d" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><path d="M 379 444.14 L 264.43 444.14 L 264.43 506.35" fill="none" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><path d="M 264.43 511.6 L 260.93 504.6 L 264.43 506.35 L 267.93 504.6 Z" fill="#4d4d4d" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><path d="M 439.21 464 L 438.55 509.8" fill="none" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><path d="M 438.48 515.05 L 435.08 508 L 438.55 509.8 L 442.08 508.1 Z" fill="#4d4d4d" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><path d="M 379 424 L 500 424 L 500 464 L 379 464 L 379 424 Z" fill="#a9c4eb" stroke="none" pointer-events="none"/><path d="M 384.04 427.33 L 384.04 460.67 L 384.04 460.67 L 494.96 460.67 L 494.96 427.33 L 384.04 427.33" fill="#a9c4eb" stroke="none" pointer-events="none"/><path d="M 379 424 L 500 424 L 500 464 L 379 464 L 379 424 Z" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="12px"><text x="438.29" y="439.79">调用 span</text><text x="438.29" y="453.79"> const child = spawn()）</text></g><path d="M 1063 446 Q 1063 446 1288.63 446" fill="none" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><path d="M 1293.88 446 L 1286.88 449.5 L 1288.63 446 L 1286.88 442.5 Z" fill="#4d4d4d" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><path d="M 953.5 466 Q 953.5 466 953.5 597.63" fill="none" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><path d="M 953.5 602.88 L 950 595.88 L 953.5 597.63 L 957 595.88 Z" fill="#4d4d4d" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><path d="M 844 426 L 1063 426 L 1063 466 L 844 466 L 844 426 Z" fill="#ffffff" stroke="none" pointer-events="none"/><path d="M 853.13 429.33 L 853.13 462.67 L 853.13 462.67 L 1053.88 462.67 L 1053.88 429.33 L 853.13 429.33" fill="#ffffff" stroke="none" pointer-events="none"/><path d="M 844 426 L 1063 426 L 1063 466 L 844 466 L 844 426 Z" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="12px"><text x="952.29" y="441.79">const child = new ChildProcess();</text><text x="952.29" y="455.79">内部创建子进程</text></g><path d="M 1108 624 Q 1108 624 1334.63 624" fill="none" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><path d="M 1339.88 624 L 1332.88 627.5 L 1334.63 624 L 1332.88 620.5 Z" fill="#4d4d4d" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><path d="M 953 644 Q 953 688.43 953 727.63" fill="none" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><path d="M 953 732.88 L 949.5 725.88 L 953 727.63 L 956.5 725.88 Z" fill="#4d4d4d" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><path d="M 799 604 L 1108 604 L 1108 644 L 799 644 L 799 604 Z" fill="#ffffff" stroke="none" pointer-events="none"/><path d="M 811.88 607.33 L 811.88 640.67 L 811.88 640.67 L 1095.13 640.67 L 1095.13 607.33 L 811.88 607.33" fill="#ffffff" stroke="none" pointer-events="none"/><path d="M 799 604 L 1108 604 L 1108 644 L 799 644 L 799 604 Z" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="12px"><text x="952.29" y="619.79">options = normalizeSpawnArguments(file, args, options);</text><text x="952.29" y="633.79">对参数进行一系列的校验及格式化</text></g><path d="M 1038.5 754.14 Q 1578.71 754.14 2108.06 754.14" fill="none" stroke="#ff99cc" stroke-miterlimit="10" pointer-events="none"/><path d="M 2113.31 754.14 L 2106.31 757.64 L 2108.06 754.14 L 2106.31 750.64 Z" fill="#ff99cc" stroke="#ff99cc" stroke-miterlimit="10" pointer-events="none"/><path d="M 953 774 Q 953 809.86 953 840.13" fill="none" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><path d="M 953 845.38 L 949.5 838.38 L 953 840.13 L 956.5 838.38 Z" fill="#4d4d4d" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><path d="M 868.5 734 L 1038.5 734 L 1038.5 774 L 868.5 774 L 868.5 734 Z" fill="#ff99cc" stroke="none" pointer-events="none"/><path d="M 875.58 737.33 L 875.58 770.67 L 875.58 770.67 L 1031.42 770.67 L 1031.42 737.33 L 875.58 737.33" fill="#ff99cc" stroke="none" pointer-events="none"/><path d="M 868.5 734 L 1038.5 734 L 1038.5 774 L 868.5 774 L 868.5 734 Z" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="12px"><text x="952.29" y="749.79">child.spawn(options);</text><text x="952.29" y="763.79">创建并执行子进程</text></g><path d="M 898 862.71 L 778.71 862.71 L 778.71 452.71 L 507.94 452.71" fill="none" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><path d="M 502.69 452.71 L 509.69 449.21 L 507.94 452.71 L 509.69 456.21 Z" fill="#4d4d4d" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><path d="M 898 846.5 L 1009 846.5 L 1009 876.5 L 898 876.5 L 898 846.5 Z" fill="#ffffff" stroke="none" pointer-events="none"/><path d="M 902.63 849 L 902.63 874 L 902.63 874 L 1004.38 874 L 1004.38 849 L 902.63 849" fill="#ffffff" stroke="none" pointer-events="none"/><path d="M 898 846.5 L 1009 846.5 L 1009 876.5 L 898 876.5 L 898 846.5 Z" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="12px"><text x="952.29" y="864.29">return child</text></g><path d="M 1404.43 466 Q 1404.43 485.57 1404.43 497.63" fill="none" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><path d="M 1404.43 502.88 L 1400.93 495.88 L 1404.43 497.63 L 1407.93 495.88 Z" fill="#4d4d4d" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><path d="M 1295 426 L 1514 426 L 1514 466 L 1295 466 L 1295 426 Z" fill="#ffffff" stroke="none" pointer-events="none"/><path d="M 1304.13 429.33 L 1304.13 462.67 L 1304.13 462.67 L 1504.88 462.67 L 1504.88 429.33 L 1304.13 429.33" fill="#ffffff" stroke="none" pointer-events="none"/><path d="M 1295 426 L 1514 426 L 1514 466 L 1295 466 L 1295 426 Z" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="12px"><text x="1403.29" y="441.79"> this._handle = new Process();</text><text x="1403.29" y="455.79">创建子进程(c++)</text></g><path d="M 1323 524.14 L 1057.29 524.14 L 1057.29 474.8" fill="none" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><path d="M 1057.29 469.55 L 1060.79 476.55 L 1057.29 474.8 L 1053.79 476.55 Z" fill="#4d4d4d" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><path d="M 1484 524 L 1640.63 524" fill="none" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><path d="M 1645.88 524 L 1638.88 527.5 L 1640.63 524 L 1638.88 520.5 Z" fill="#4d4d4d" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><path d="M 1324 504 L 1484 504 L 1484 544 L 1324 544 L 1324 504 Z" fill="#9999ff" stroke="none" pointer-events="none"/><path d="M 1330.67 507.33 L 1330.67 540.67 L 1330.67 540.67 L 1477.33 540.67 L 1477.33 507.33 L 1330.67 507.33" fill="#9999ff" stroke="none" pointer-events="none"/><path d="M 1324 504 L 1484 504 L 1484 544 L 1324 544 L 1324 504 Z" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="12px"><text x="1402.79" y="519.79"> this._handle.onexit</text><text x="1402.79" y="533.79">注册进程退出的回调</text></g><path d="M 1727.29 544 L 1727.29 564.14 L 1727.29 554.14 L 1727.29 567.63" fill="none" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><path d="M 1727.29 572.88 L 1723.79 565.88 L 1727.29 567.63 L 1730.79 565.88 Z" fill="#4d4d4d" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><path d="M 1647 504 L 1807 504 L 1807 544 L 1647 544 L 1647 504 Z" fill="#9999ff" stroke="none" pointer-events="none"/><path d="M 1653.67 507.33 L 1653.67 540.67 L 1653.67 540.67 L 1800.33 540.67 L 1800.33 507.33 L 1653.67 507.33" fill="#9999ff" stroke="none" pointer-events="none"/><path d="M 1647 504 L 1807 504 L 1807 544 L 1647 544 L 1647 504 Z" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="12px"><text x="1725.79" y="526.79"> this.stdin.destroy();</text></g><path d="M 1727.08 614 L 1727.18 640.66" fill="none" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><path d="M 1727.2 645.91 L 1723.67 638.93 L 1727.18 640.66 L 1730.67 638.9 Z" fill="#4d4d4d" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><path d="M 1647 574 L 1807 574 L 1807 614 L 1647 614 L 1647 574 Z" fill="#9999ff" stroke="none" pointer-events="none"/><path d="M 1653.67 577.33 L 1653.67 610.67 L 1653.67 610.67 L 1800.33 610.67 L 1800.33 577.33 L 1653.67 577.33" fill="#9999ff" stroke="none" pointer-events="none"/><path d="M 1647 574 L 1807 574 L 1807 614 L 1647 614 L 1647 574 Z" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="12px"><text x="1725.79" y="596.79">this._handle.close();</text></g><path d="M 329 0.5 L 699 0.5 L 699 50.5 L 329 50.5 L 329 0.5 Z" fill="#ffffff" stroke="none" pointer-events="none"/><path d="M 344.42 4.67 L 344.42 46.33 L 344.42 46.33 L 683.58 46.33 L 683.58 4.67 L 344.42 4.67" fill="#ffffff" stroke="none" pointer-events="none"/><path d="M 329 0.5 L 699 0.5 L 699 50.5 L 329 50.5 L 329 0.5 Z" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="12px"><text x="512.79" y="28.29">  const opts = normalizeExecArgs(command, options, callback);</text></g><g transform="translate(801.5,260.5)"><foreignObject style="overflow:visible;" pointer-events="all" width="1" height="18"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; white-space: nowrap; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;"><div style="color: rgb(171 , 178 , 191) ; background-color: rgb(22 , 27 , 34) ; font-family: &quot;jetbrains mono&quot; , &quot;fira code light&quot; , &quot;consolas&quot; , &quot;courier new&quot; , monospace ; line-height: 168% ; white-space: pre ; font-size: 10px"><div style="font-size: 10px"><br/></div></div></div></div></foreignObject></g><path d="M 1405.86 654 Q 1405.86 674.14 1405.86 666.29 Q 1405.86 658.43 1405.86 672.13" fill="none" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><path d="M 1405.86 677.38 L 1402.36 670.38 L 1405.86 672.13 L 1409.36 670.38 Z" fill="#4d4d4d" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><path d="M 1406 594 L 1471 624 L 1406 654 L 1341 624 Z" fill="#99ccff" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="12px"><text x="1404.79" y="619.79">if (options.shell)</text><text x="1404.79" y="633.79">所有校验都通过</text></g><path d="M 1406 747.52 L 1207.17 852.06" fill="none" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><path d="M 1202.53 854.5 L 1207.09 848.14 L 1207.17 852.06 L 1210.35 854.34 Z" fill="#4d4d4d" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(1297.5,792.5)"><foreignObject style="overflow:visible;" pointer-events="all" width="18" height="12"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; white-space: nowrap; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;background-color:#ffffff;">win</div></div></foreignObject></g><path d="M 1405.59 748.5 L 1404.43 847.63" fill="none" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><path d="M 1404.37 852.88 L 1400.95 845.84 L 1404.43 847.63 L 1407.95 845.92 Z" fill="#4d4d4d" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(1382.5,793.5)"><foreignObject style="overflow:visible;" pointer-events="all" width="40" height="12"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; white-space: nowrap; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;background-color:#ffffff;">android</div></div></foreignObject></g><path d="M 1406 678.5 L 1521 713.5 L 1406 748.5 L 1291 713.5 Z" fill="#99ccff" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="12px"><text x="1404.79" y="709.29">if (process.platform === 'win32')</text><text x="1404.79" y="723.29">校验 win 和 unix 平台</text></g><path d="M 1253.51 914 L 1390.64 1000.6" fill="none" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><path d="M 1395.07 1003.4 L 1387.29 1002.62 L 1390.64 1000.6 L 1391.02 996.71 Z" fill="#4d4d4d" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><path d="M 1113 854 L 1299 854 L 1299 914 L 1113 914 L 1113 854 Z" fill="#ffffff" stroke="none" pointer-events="none"/><path d="M 1120.75 859 L 1120.75 909 L 1120.75 909 L 1291.25 909 L 1291.25 859 L 1120.75 859" fill="#ffffff" stroke="none" pointer-events="none"/><path d="M 1113 854 L 1299 854 L 1299 914 L 1113 914 L 1113 854 Z" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="12px"><text x="1204.79" y="886.79"> process.env.comspec || 'cmd.exe';</text></g><path d="M 1404 914 L 1404 997.63" fill="none" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><path d="M 1404 1002.88 L 1400.5 995.88 L 1404 997.63 L 1407.5 995.88 Z" fill="#4d4d4d" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><path d="M 1334 854 L 1474 854 L 1474 914 L 1334 914 L 1334 854 Z" fill="#ffffff" stroke="none" pointer-events="none"/><path d="M 1339.83 859 L 1339.83 909 L 1339.83 909 L 1468.17 909 L 1468.17 859 L 1339.83 859" fill="#ffffff" stroke="none" pointer-events="none"/><path d="M 1334 854 L 1474 854 L 1474 914 L 1334 914 L 1334 854 Z" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="12px"><text x="1402.79" y="886.79">file = '/system/bin/sh';</text></g><path d="M 1539.49 914 L 1417.18 1000.33" fill="none" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><path d="M 1412.89 1003.36 L 1416.59 996.46 L 1417.18 1000.33 L 1420.63 1002.18 Z" fill="#4d4d4d" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><path d="M 1512 854 L 1652 854 L 1652 914 L 1512 914 L 1512 854 Z" fill="#ffffff" stroke="none" pointer-events="none"/><path d="M 1517.83 859 L 1517.83 909 L 1517.83 909 L 1646.17 909 L 1646.17 859 L 1517.83 859" fill="#ffffff" stroke="none" pointer-events="none"/><path d="M 1512 854 L 1652 854 L 1652 914 L 1512 914 L 1512 854 Z" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="12px"><text x="1580.79" y="886.79"> file = '/bin/sh';</text></g><path d="M 1403.93 747.52 L 1584.06 852.77" fill="none" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><path d="M 1588.59 855.42 L 1580.79 854.91 L 1584.06 852.77 L 1584.32 848.86 Z" fill="#4d4d4d" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(1486.5,791.5)"><foreignObject style="overflow:visible;" pointer-events="all" width="22" height="12"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; white-space: nowrap; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;background-color:#ffffff;">unix</div></div></foreignObject></g><path d="M 1404 1054 L 1404 1090.63" fill="none" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><path d="M 1404 1095.88 L 1400.5 1088.88 L 1404 1090.63 L 1407.5 1088.88 Z" fill="#4d4d4d" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><rect x="1334" y="1004" width="140" height="50" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(1358.5,1021.5)"><foreignObject style="overflow:visible;" pointer-events="all" width="89" height="12"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 89px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;"><span style="text-align: left">args.unshift(file);<br/></span></div></div></foreignObject></g><path d="M 1403.99 1147 L 1403.96 1209.56" fill="none" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><path d="M 1403.96 1214.81 L 1400.46 1207.81 L 1403.96 1209.56 L 1407.46 1207.81 Z" fill="#4d4d4d" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(1387.5,1176.5)"><foreignObject style="overflow:visible;" pointer-events="all" width="31" height="12"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; white-space: nowrap; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;background-color:#ffffff;">return</div></div></foreignObject></g><rect x="1334" y="1097" width="140" height="50" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(1334.5,1107.5)"><foreignObject style="overflow:visible;" pointer-events="all" width="137" height="26"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 137px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;"><span style="text-align: left">将环境变量的键值对添加到 envPairs</span></div></div></foreignObject></g><g transform="translate(1482.5,1015.5)"><foreignObject style="overflow:visible;" pointer-events="all" width="264" height="26"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; white-space: nowrap; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">是否有显示的指定 argv0，如果没有，<br/>则会为 command(根据不同平台为不同 command)</div></div></foreignObject></g><path d="M 1275.86 1302.71 L 1098.71 1302.71 L 1098.71 649.08" fill="none" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><path d="M 1098.71 643.83 L 1102.21 650.83 L 1098.71 649.08 L 1095.21 650.83 Z" fill="#4d4d4d" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><rect x="1275" y="1216.5" width="520" height="190" fill="none" stroke="#666666" stroke-dasharray="3 3" pointer-events="none"/><g transform="translate(1276.5,1220.5)"><foreignObject style="overflow:visible;" pointer-events="all" width="504" height="180"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; white-space: nowrap; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;"><span style="font-family: &quot;jetbrains mono&quot; , &quot;fira code light&quot; , &quot;consolas&quot; , &quot;courier new&quot; , monospace ; font-size: 11px ; white-space: pre">{</span><br/><span style="font-family: &quot;jetbrains mono&quot; , &quot;fira code light&quot; , &quot;consolas&quot; , &quot;courier new&quot; , monospace ; font-size: 11px ; white-space: pre">  cwd: null,</span><br/><span style="font-family: &quot;jetbrains mono&quot; , &quot;fira code light&quot; , &quot;consolas&quot; , &quot;courier new&quot; , monospace ; font-size: 11px ; white-space: pre">  env: null,</span><br/><span style="font-family: &quot;jetbrains mono&quot; , &quot;fira code light&quot; , &quot;consolas&quot; , &quot;courier new&quot; , monospace ; font-size: 11px ; white-space: pre">  gid: undefined,</span><br/><span style="font-family: &quot;jetbrains mono&quot; , &quot;fira code light&quot; , &quot;consolas&quot; , &quot;courier new&quot; , monospace ; font-size: 11px ; white-space: pre">  uid: undefined,</span><br/><span style="font-family: &quot;jetbrains mono&quot; , &quot;fira code light&quot; , &quot;consolas&quot; , &quot;courier new&quot; , monospace ; font-size: 11px ; white-space: pre">  shell: true,</span><br/><span style="font-family: &quot;jetbrains mono&quot; , &quot;fira code light&quot; , &quot;consolas&quot; , &quot;courier new&quot; , monospace ; font-size: 11px ; white-space: pre">  windowsHide: false,</span><br/><span style="font-family: &quot;jetbrains mono&quot; , &quot;fira code light&quot; , &quot;consolas&quot; , &quot;courier new&quot; , monospace ; font-size: 11px ; white-space: pre">  windowsVerbatimArguments: true,</span><br/><span style="font-family: &quot;jetbrains mono&quot; , &quot;fira code light&quot; , &quot;consolas&quot; , &quot;courier new&quot; , monospace ; font-size: 11px ; white-space: pre">  args: </span><font face="jetbrains mono, fira code light, consolas, courier new, monospace"><span style="font-size: 11px ; white-space: pre">[ "C:\\Windows\\system32\\cmd.exe","/d", "/s", "/c","\"ls\"",]</span></font><br/><span style="font-family: &quot;jetbrains mono&quot; , &quot;fira code light&quot; , &quot;consolas&quot; , &quot;courier new&quot; , monospace ; font-size: 11px ; white-space: pre">  detached: false,</span><br/><span style="font-family: &quot;jetbrains mono&quot; , &quot;fira code light&quot; , &quot;consolas&quot; , &quot;courier new&quot; , monospace ; font-size: 11px ; white-space: pre">  envPairs: [...</span><span style="font-family: &quot;jetbrains mono&quot; , &quot;fira code light&quot; , &quot;consolas&quot; , &quot;courier new&quot; , monospace ; font-size: 11px ; white-space: pre">],</span><br/><span style="font-family: &quot;jetbrains mono&quot; , &quot;fira code light&quot; , &quot;consolas&quot; , &quot;courier new&quot; , monospace ; font-size: 11px ; white-space: pre">  file: "C:\\Windows\\system32\\cmd.exe",</span><br/><span style="font-family: &quot;jetbrains mono&quot; , &quot;fira code light&quot; , &quot;consolas&quot; , &quot;courier new&quot; , monospace ; font-size: 11px ; white-space: pre">}</span></div></div></foreignObject></g><path d="M 2219 776.5 Q 2219 776.5 2219 850.13" fill="none" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><path d="M 2219 855.38 L 2215.5 848.38 L 2219 850.13 L 2222.5 848.38 Z" fill="#4d4d4d" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><rect x="2119" y="731.5" width="200" height="45" fill="#ff99cc" stroke="#000000" pointer-events="none"/><g transform="translate(2135.5,739.5)"><foreignObject style="overflow:visible;" pointer-events="all" width="165" height="26"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 167px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;"><span style="text-align: left">let stdio = options.stdio || 'pipe';<br/>stdio 默认为 pipe<br/></span></div></div></foreignObject></g><path d="M 2319 879 Q 2319 879 2422.63 879" fill="none" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><path d="M 2427.88 879 L 2420.88 882.5 L 2422.63 879 L 2420.88 875.5 Z" fill="#4d4d4d" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><path d="M 2219 901.5 Q 2219 901.5 2219 949.63" fill="none" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><path d="M 2219 954.88 L 2215.5 947.88 L 2219 949.63 L 2222.5 947.88 Z" fill="#4d4d4d" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><rect x="2119" y="856.5" width="200" height="45" fill="#ff99cc" stroke="#000000" pointer-events="none"/><g transform="translate(2129.5,864.5)"><foreignObject style="overflow:visible;" pointer-events="all" width="177" height="26"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 179px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;"><span style="text-align: left ; white-space: nowrap">stdio = getValidStdio(stdio, false);<br/></span><span style="text-align: left">创建管道<br/></span></div></div></foreignObject></g><path d="M 2219 1001 Q 2219 1001 2219 1048.63" fill="none" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><path d="M 2219 1053.88 L 2215.5 1046.88 L 2219 1048.63 L 2222.5 1046.88 Z" fill="#4d4d4d" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><rect x="2119" y="956" width="200" height="45" fill="#ff99cc" stroke="#000000" pointer-events="none"/><g transform="translate(2149.5,964.5)"><foreignObject style="overflow:visible;" pointer-events="all" width="137" height="26"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 137px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;"><span style="text-align: left ; white-space: nowrap">const ipc = stdio.ipc;  <br/>const ipcFd = stdio.ipcFd;</span><span style="text-align: left"><br/></span></div></div></foreignObject></g><path d="M 2219 1100 Q 2219 1100 2219 1152.63" fill="none" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><path d="M 2219 1157.88 L 2215.5 1150.88 L 2219 1152.63 L 2222.5 1150.88 Z" fill="#4d4d4d" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><rect x="2119" y="1055" width="200" height="45" fill="#ff99cc" stroke="#000000" pointer-events="none"/><g transform="translate(2129.5,1070.5)"><foreignObject style="overflow:visible;" pointer-events="all" width="177" height="12"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 179px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;"><span style="text-align: left ; white-space: nowrap">stdio = options.stdio = stdio.stdio;</span><span style="text-align: left"><br/></span></div></div></foreignObject></g><path d="M 2219 1208 Q 2219 1208 2219 1281.63" fill="none" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><path d="M 2219 1286.88 L 2215.5 1279.88 L 2219 1281.63 L 2222.5 1279.88 Z" fill="#4d4d4d" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><rect x="2109" y="1159" width="220" height="49" fill="#ff99cc" stroke="#000000" pointer-events="none"/><g transform="translate(2111.5,1169.5)"><foreignObject style="overflow:visible;" pointer-events="all" width="213" height="26"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 215px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;"><span style="text-align: left ; white-space: nowrap">const err = this._handle.spawn(options);<br/></span><span style="text-align: left">创建子进程<br/></span></div></div></foreignObject></g><path d="M 2329 1312.5 Q 2329 1312.5 2402.63 1312.5" fill="none" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><path d="M 2407.88 1312.5 L 2400.88 1316 L 2402.63 1312.5 L 2400.88 1309 Z" fill="#4d4d4d" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><rect x="2109" y="1288" width="220" height="49" fill="#ff99cc" stroke="#000000" pointer-events="none"/><g transform="translate(2113.5,1305.5)"><foreignObject style="overflow:visible;" pointer-events="all" width="209" height="12"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 211px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;"><span style="text-align: left"><span style="white-space: nowrap">遍历 管道数组，为每个管道创建 socket</span><br/></span></div></div></foreignObject></g><path d="M 2599 1312.5 Q 2599 1312.5 2672.63 1312.5" fill="none" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><path d="M 2677.88 1312.5 L 2670.88 1316 L 2672.63 1312.5 L 2670.88 1309 Z" fill="#4d4d4d" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><path d="M 2504 1333 Q 2504 1333 2504 1382.63" fill="none" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><path d="M 2504 1387.88 L 2500.5 1380.88 L 2504 1382.63 L 2507.5 1380.88 Z" fill="#4d4d4d" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(2414.5,1347.5)"><foreignObject style="overflow:visible;" pointer-events="all" width="179" height="12"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 11px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; white-space: nowrap; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;background-color:#ffffff;">给输出流和错误流添加 close 回调</div></div></foreignObject></g><rect x="2409" y="1292" width="190" height="41" fill="#ff99cc" stroke="#000000" pointer-events="none"/><g transform="translate(2419.5,1305.5)"><foreignObject style="overflow:visible;" pointer-events="all" width="167" height="12"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 167px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;"><span style="text-align: left ; white-space: nowrap">stream.socket = </span><span style="text-align: left ; white-space: nowrap">createSocket()</span><span style="text-align: left"><br/></span></div></div></foreignObject></g><path d="M 2504 1485 Q 2504 1485 2504 1522.63" fill="none" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><path d="M 2504 1527.88 L 2500.5 1520.88 L 2504 1522.63 L 2507.5 1520.88 Z" fill="#4d4d4d" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><rect x="2399" y="1389" width="210" height="96" fill="#9999ff" stroke="#000000" pointer-events="none"/><g transform="translate(2402.5,1394.5)"><foreignObject style="overflow:visible;" pointer-events="all" width="194" height="82"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 195px; white-space: nowrap; overflow-wrap: normal; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;"><span style="white-space: nowrap">if (i &gt; 0 &amp;&amp; this.pid !== 0) {<br/>        this._closesNeeded++; <br/>       stream.socket.on('close', () =&gt; { <br/>         <font color="#cc0066"><b>maybeClose(this);</b> </font>       <br/>       });      <br/>}</span></div></div></foreignObject></g><path d="M 2504 1609 Q 2504 1609 2504 1657.63" fill="none" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><path d="M 2504 1662.88 L 2500.5 1655.88 L 2504 1657.63 L 2507.5 1655.88 Z" fill="#4d4d4d" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><rect x="2394" y="1529" width="220" height="80" fill="#ff99cc" stroke="#000000" pointer-events="none"/><g transform="translate(2397.5,1540.5)"><foreignObject style="overflow:visible;" pointer-events="all" width="192" height="54"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 193px; white-space: nowrap; overflow-wrap: normal; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;"><span style="white-space: nowrap">拿到三个流，源码中还做了非空校验<br/>this.stdin = stdio[0].socket ;  <br/>this.stdout = stdio[1].socket ;  <br/>this.stderr = stdio[2].socket ;</span><span><br/></span></div></div></foreignObject></g><path d="M 2504.43 1734 Q 2504.43 1757 2504.43 1772.63" fill="none" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><path d="M 2504.43 1777.88 L 2500.93 1770.88 L 2504.43 1772.63 L 2507.93 1770.88 Z" fill="#4d4d4d" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><rect x="2394" y="1664" width="220" height="70" fill="#ff99cc" stroke="#000000" pointer-events="none"/><g transform="translate(2397.5,1677.5)"><foreignObject style="overflow:visible;" pointer-events="all" width="161" height="40"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 162px; white-space: nowrap; overflow-wrap: normal; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;"><span><span style="white-space: nowrap">遍历这三个流，<br/>将其添加到 this.stdio 数组中<br/></span></span><span style="white-space: nowrap">this.stdio.push(stdio[i].socket);</span><span><br/></span></div></div></foreignObject></g><path d="M 2504.43 1856 Q 2504.43 1882.71 2504.43 1902.63" fill="none" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><path d="M 2504.43 1907.88 L 2500.93 1900.88 L 2504.43 1902.63 L 2507.93 1900.88 Z" fill="#4d4d4d" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><rect x="2391.5" y="1779" width="225" height="77" fill="#ff99cc" stroke="#000000" pointer-events="none"/><g transform="translate(2395.5,1789.5)"><foreignObject style="overflow:visible;" pointer-events="all" width="213" height="54"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 214px; white-space: nowrap; overflow-wrap: normal; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;"><span style="white-space: nowrap">如果是 fork 创建的子进程<br/>则会通过 Ipc 创建两边通信的频道<br/>if (ipc !== undefined) <br/>     setupChannel(this, ipc, serialization);</span><span><br/></span></div></div></foreignObject></g><path d="M 2465 1919.86 L 1023 1919.86 L 1023 780.51" fill="none" stroke="#999999" stroke-miterlimit="10" pointer-events="none"/><path d="M 1023 775.26 L 1026.5 782.26 L 1023 780.51 L 1019.5 782.26 Z" fill="#999999" stroke="#999999" stroke-miterlimit="10" pointer-events="none"/><rect x="2465" y="1909" width="78" height="23" fill="#ff99cc" stroke="#000000" pointer-events="none"/><g transform="translate(2468.5,1913.5)"><foreignObject style="overflow:visible;" pointer-events="all" width="49" height="12"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 50px; white-space: nowrap; overflow-wrap: normal; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;"><span><span style="white-space: nowrap">return err</span><br/></span></div></div></foreignObject></g><path d="M 3069 1312.5 L 3141.63 1312.5" fill="none" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><path d="M 3146.88 1312.5 L 3139.88 1316 L 3141.63 1312.5 L 3139.88 1309 Z" fill="#4d4d4d" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><rect x="2679" y="1294" width="390" height="37" fill="#ff99cc" stroke="#000000" pointer-events="none"/><g transform="translate(2702.5,1305.5)"><foreignObject style="overflow:visible;" pointer-events="all" width="341" height="12"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 341px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;"><span style="text-align: left ; white-space: nowrap">return net.Socket({ handle: pipe, readable, writable: !readable });</span><span style="text-align: left"><br/></span></div></div></foreignObject></g><path d="M 3353 1416.87 L 3426.99 1417.14" fill="none" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><path d="M 3432.24 1417.16 L 3425.23 1420.63 L 3426.99 1417.14 L 3425.25 1413.63 Z" fill="#4d4d4d" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><rect x="3153" y="1399" width="200" height="35" fill="#ff99cc" stroke="#000000" pointer-events="none"/><g transform="translate(3184.5,1402.5)"><foreignObject style="overflow:visible;" pointer-events="all" width="135" height="26"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 137px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;"><span style="text-align: left ; white-space: nowrap">initSocketHandle<br/></span><span style="text-align: left">添加 </span><span style="text-align: left ; white-space: nowrap">onStreamRead 监听</span><span style="text-align: left"><br/></span></div></div></foreignObject></g><path d="M 2529 901.5 Q 2529 901.5 2529 949.63" fill="none" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><path d="M 2529 954.88 L 2525.5 947.88 L 2529 949.63 L 2532.5 947.88 Z" fill="#4d4d4d" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><rect x="2429" y="856.5" width="200" height="45" fill="#ff99cc" stroke="#000000" pointer-events="none"/><g transform="translate(2429.5,857.5)"><foreignObject style="overflow:visible;" pointer-events="all" width="197" height="40"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 197px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;"><span style="text-align: left ; white-space: nowrap">stdio = stdioStringToArray(stdio);<br/></span><span style="text-align: left">将其转换为 输入，输出，错误流的三个数组<br/></span></div></div></foreignObject></g><path d="M 2639 975.57 Q 2728.71 975.57 2728.71 974.86 Q 2728.71 974.14 2810.92 974.14" fill="none" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><path d="M 2816.17 974.14 L 2809.17 977.64 L 2810.92 974.14 L 2809.17 970.64 Z" fill="#4d4d4d" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(2662.5,960.5)"><foreignObject style="overflow:visible;" pointer-events="all" width="128" height="26"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; white-space: nowrap; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;background-color:#ffffff;">会根据不同的 stdio 类型<br/>创建不同的管道</div></div></foreignObject></g><path d="M 2529 994 Q 2529 994 2529 1048.63" fill="none" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><path d="M 2529 1053.88 L 2525.5 1046.88 L 2529 1048.63 L 2532.5 1046.88 Z" fill="#4d4d4d" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><rect x="2419" y="956" width="220" height="38" fill="#ff99cc" stroke="#000000" pointer-events="none"/><g transform="translate(2421.5,960.5)"><foreignObject style="overflow:visible;" pointer-events="all" width="213" height="26"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 213px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;"><span style="text-align: left ; white-space: nowrap">stdio = stdio.reduce((acc, stdio, i)=&gt;{},[])<br/></span><span style="text-align: left">遍历这个 数组，创建管道<br/></span></div></div></foreignObject></g><path d="M 2419 1077 Q 2314.43 1077 2314.43 907.65" fill="none" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><path d="M 2314.43 902.4 L 2317.93 909.4 L 2314.43 907.65 L 2310.93 909.4 Z" fill="#4d4d4d" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><rect x="2419" y="1055" width="220" height="44" fill="#ff99cc" stroke="#000000" pointer-events="none"/><g transform="translate(2434.5,1062.5)"><foreignObject style="overflow:visible;" pointer-events="all" width="187" height="26"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 187px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;"><span style="text-align: left ; white-space: nowrap">return { stdio, ipc, ipcFd };<br/></span><span style="text-align: left">ipc,ipcFd 在使用 fork 的时候会用到<br/></span></div></div></foreignObject></g><rect x="2819" y="950.5" width="270" height="47" fill="#ff99cc" stroke="#000000" pointer-events="none"/><g transform="translate(2827.5,959.5)"><foreignObject style="overflow:visible;" pointer-events="all" width="251" height="26"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 253px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;"><span style="text-align: left ; white-space: nowrap">a.handle = new Pipe(PipeConstants.SOCKET);<br/></span><span style="text-align: left">创建管道 -&gt; C++<br/></span></div></div></foreignObject></g><g transform="translate(2507.5,831.5)"><foreignObject style="overflow:visible;" pointer-events="all" width="102" height="12"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; white-space: nowrap; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">['pipe', 'pipe', 'pipe']</div></div></foreignObject></g><path d="M 261.57 582.71 L 261.57 632.71 L 380.14 632.71 L 380.14 674.92" fill="none" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><path d="M 380.14 680.17 L 376.64 673.17 L 380.14 674.92 L 383.64 673.17 Z" fill="#4d4d4d" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(251.5,598.5)"><foreignObject style="overflow:visible;" pointer-events="all" width="21" height="12"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; white-space: nowrap; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;background-color:#ffffff;">true</div></div></foreignObject></g><path d="M 264.5 514 L 329.5 549 L 264.5 584 L 199.5 549 Z" fill="#ffffff" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="12px"><text x="263.29" y="544.79"> if (child.stdout)</text><text x="263.29" y="558.79">判断是否有输出流</text></g><path d="M 438.71 720.5 Q 438.71 741.29 438.71 753.49" fill="none" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><path d="M 438.71 758.74 L 435.21 751.74 L 438.71 753.49 L 442.21 751.74 Z" fill="#4d4d4d" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><path d="M 503 465.57 L 588.71 465.57 L 588.71 1022.71 L 510.8 1022.71" fill="none" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><path d="M 505.55 1022.71 L 512.55 1019.21 L 510.8 1022.71 L 512.55 1026.21 Z" fill="#4d4d4d" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><path d="M 368.5 680.5 L 508.5 680.5 L 508.5 720.5 L 368.5 720.5 L 368.5 680.5 Z" fill="#9999ff" stroke="none" pointer-events="none"/><path d="M 374.33 683.83 L 374.33 717.17 L 374.33 717.17 L 502.67 717.17 L 502.67 683.83 L 374.33 683.83" fill="#9999ff" stroke="none" pointer-events="none"/><path d="M 368.5 680.5 L 508.5 680.5 L 508.5 720.5 L 368.5 720.5 L 368.5 680.5 Z" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="12px"><text x="437.29" y="703.29">添加 on("data") 监听，</text></g><path d="M 437.29 809.86 Q 438.71 809.86 438.71 822 Q 438.71 834.14 438.71 861.63" fill="none" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><path d="M 438.71 866.88 L 435.21 859.88 L 438.71 861.63 L 442.21 859.88 Z" fill="#4d4d4d" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(425.5,826.5)"><foreignObject style="overflow:visible;" pointer-events="all" width="25" height="12"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 11px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; white-space: nowrap; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;background-color:#ffffff;">false</div></div></foreignObject></g><path d="M 362.5 868 L 512.5 868 L 512.5 908 L 362.5 908 L 362.5 868 Z" fill="#ffffff" stroke="none" pointer-events="none"/><path d="M 368.75 871.33 L 368.75 904.67 L 368.75 904.67 L 506.25 904.67 L 506.25 871.33 L 368.75 871.33" fill="#ffffff" stroke="none" pointer-events="none"/><path d="M 362.5 868 L 512.5 868 L 512.5 908 L 362.5 908 L 362.5 868 Z" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="12px"><text x="436.29" y="890.79">_stdout.push(chunk);</text></g><path d="M 362.5 784.14 Q 333 784.14 307.94 784.14" fill="none" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><path d="M 302.69 784.14 L 309.69 780.64 L 307.94 784.14 L 309.69 787.64 Z" fill="#4d4d4d" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><path d="M 437.5 760.5 L 512.5 784 L 437.5 807.5 L 362.5 784 Z" fill="#ffffff" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="12px"><text x="436.29" y="786.79">判断是否超过 maxBuffer</text></g><path d="M 224.5 781 L 151.37 781" fill="none" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><path d="M 146.12 781 L 153.12 777.5 L 151.37 781 L 153.12 784.5 Z" fill="#4d4d4d" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><path d="M 224.5 763 L 304.5 763 L 304.5 799 L 224.5 799 L 224.5 763 Z" fill="#ff6666" stroke="none" pointer-events="none"/><path d="M 227.83 766 L 227.83 796 L 227.83 796 L 301.17 796 L 301.17 766 L 227.83 766" fill="#ff6666" stroke="none" pointer-events="none"/><path d="M 224.5 763 L 304.5 763 L 304.5 799 L 224.5 799 L 224.5 763 Z" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="12px"><text x="263.29" y="783.79">kill()</text></g><path d="M 72.5 799 L 72.5 837.13" fill="none" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><path d="M 72.5 842.38 L 69 835.38 L 72.5 837.13 L 76 835.38 Z" fill="#4d4d4d" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><path d="M 0 763 L 145 763 L 145 799 L 0 799 L 0 763 Z" fill="#ffffff" stroke="none" pointer-events="none"/><path d="M 6.04 766 L 6.04 796 L 6.04 796 L 138.96 796 L 138.96 766 L 6.04 766" fill="#ffffff" stroke="none" pointer-events="none"/><path d="M 0 763 L 145 763 L 145 799 L 0 799 L 0 763 Z" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="12px"><text x="71.29" y="783.79"> child.stdout.destroy();</text></g><path d="M 72.5 879.5 L 72.5 918.63" fill="none" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><path d="M 72.5 923.88 L 69 916.88 L 72.5 918.63 L 76 916.88 Z" fill="#4d4d4d" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><path d="M 0 843.5 L 145 843.5 L 145 879.5 L 0 879.5 L 0 843.5 Z" fill="#ffffff" stroke="none" pointer-events="none"/><path d="M 6.04 846.5 L 6.04 876.5 L 6.04 876.5 L 138.96 876.5 L 138.96 846.5 L 6.04 846.5" fill="#ffffff" stroke="none" pointer-events="none"/><path d="M 0 843.5 L 145 843.5 L 145 879.5 L 0 879.5 L 0 843.5 Z" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="12px"><text x="71.29" y="864.29">child.stderr.destroy();</text></g><path d="M 0 925 L 145 925 L 145 961 L 0 961 L 0 925 Z" fill="#ffffff" stroke="none" pointer-events="none"/><path d="M 6.04 928 L 6.04 958 L 6.04 958 L 138.96 958 L 138.96 928 L 6.04 928" fill="#ffffff" stroke="none" pointer-events="none"/><path d="M 0 925 L 145 925 L 145 961 L 0 961 L 0 925 Z" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="12px"><text x="71.29" y="945.79">child.kill(options.killSignal);</text></g><path d="M 439.27 584 L 438.67 674.13" fill="none" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><path d="M 438.64 679.38 L 435.19 672.36 L 438.67 674.13 L 442.19 672.41 Z" fill="#4d4d4d" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(430.5,604.5)"><foreignObject style="overflow:visible;" pointer-events="all" width="21" height="12"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(26, 26, 26); line-height: 1.2; vertical-align: top; white-space: nowrap; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;background-color:#ffffff;">true</div></div></foreignObject></g><path d="M 439.5 514 L 504.5 549 L 439.5 584 L 374.5 549 Z" fill="#ffffff" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="12px"><text x="438.29" y="544.79"> if (child.stderr)</text><text x="438.29" y="558.79">判断是否有错误流</text></g><path d="M 1677 667.77 L 1641.37 667.97" fill="none" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><path d="M 1636.12 667.99 L 1643.1 664.46 L 1641.37 667.97 L 1643.14 671.46 Z" fill="#4d4d4d" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><path d="M 1777 666.74 L 1819.66 666.09" fill="none" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><path d="M 1824.91 666.01 L 1817.97 669.61 L 1819.66 666.09 L 1817.86 662.61 Z" fill="#4d4d4d" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><path d="M 1727.24 689 L 1727.48 710.78" fill="none" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><path d="M 1727.54 716.03 L 1723.96 709.07 L 1727.48 710.78 L 1730.96 708.99 Z" fill="#4d4d4d" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><path d="M 1727 646 L 1777 667.5 L 1727 689 L 1677 667.5 Z" fill="#ffffff" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="12px"><text x="1725.79" y="670.29">是否发生错误</text></g><path d="M 1512 646 L 1632 646 L 1632 686 L 1512 686 L 1512 646 Z" fill="#9999ff" stroke="none" pointer-events="none"/><path d="M 1517 649.33 L 1517 682.67 L 1517 682.67 L 1627 682.67 L 1627 649.33 L 1517 649.33" fill="#9999ff" stroke="none" pointer-events="none"/><path d="M 1512 646 L 1632 646 L 1632 686 L 1512 686 L 1512 646 Z" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="12px"><text x="1570.79" y="668.79"> this.emit('error', err);</text></g><path d="M 1829 646 L 2099 646 L 2099 684 L 1829 684 L 1829 646 Z" fill="#9999ff" stroke="none" pointer-events="none"/><path d="M 1840.25 649.17 L 1840.25 680.83 L 1840.25 680.83 L 2087.75 680.83 L 2087.75 649.17 L 1840.25 649.17" fill="#9999ff" stroke="none" pointer-events="none"/><path d="M 1829 646 L 2099 646 L 2099 684 L 1829 684 L 1829 646 Z" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="12px"><text x="1962.79" y="667.79">this.emit('exit', this.exitCode, this.signalCode);</text></g><path d="M 1676 718.5 L 1781 718.5 L 1781 748.5 L 1676 748.5 L 1676 718.5 Z" fill="#ffff66" stroke="none" pointer-events="none"/><path d="M 1680.38 721 L 1680.38 746 L 1680.38 746 L 1776.63 746 L 1776.63 721 L 1680.38 721" fill="#ffff66" stroke="none" pointer-events="none"/><path d="M 1676 718.5 L 1781 718.5 L 1781 748.5 L 1676 748.5 L 1676 718.5 Z" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="12px"><text x="1727.29" y="736.29">maybeClose(this);</text></g><path d="M 3752.29 374.45 L 3813.81 363.16" fill="none" stroke="#4d4d4d" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="none"/><path d="M 3818.97 362.21 L 3812.72 366.91 L 3813.81 363.16 L 3811.45 360.03 Z" fill="#4d4d4d" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><path d="M 3753.31 399.15 L 3810.85 411.65" fill="none" stroke="#4d4d4d" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="none"/><path d="M 3815.98 412.76 L 3808.4 414.7 L 3810.85 411.65 L 3809.88 407.86 Z" fill="#4d4d4d" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><path d="M 3579.57 361.5 L 3749.57 361.5 L 3749.57 411.5 L 3579.57 411.5 L 3579.57 361.5 Z" fill="#ffff99" stroke="none" pointer-events="none"/><path d="M 3586.65 365.67 L 3586.65 407.33 L 3586.65 407.33 L 3742.49 407.33 L 3742.49 365.67 L 3586.65 365.67" fill="#ffff99" stroke="none" pointer-events="none"/><path d="M 3579.57 361.5 L 3749.57 361.5 L 3749.57 411.5 L 3579.57 411.5 L 3579.57 361.5 Z" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="12px"><text x="3663.36" y="389.29">stream.emit('data', chunk);</text></g><path d="M 3820.07 327 L 3978.07 327 L 3978.07 368 L 3820.07 368 L 3820.07 327 Z" fill="#ffff99" stroke="none" pointer-events="none"/><path d="M 3826.65 330.42 L 3826.65 364.58 L 3826.65 364.58 L 3971.49 364.58 L 3971.49 330.42 L 3826.65 330.42" fill="#ffff99" stroke="none" pointer-events="none"/><path d="M 3820.07 327 L 3978.07 327 L 3978.07 368 L 3820.07 368 L 3820.07 327 Z" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="12px"><text x="3897.86" y="350.29">stdout.on('data')</text></g><path d="M 3493.16 1444 L 3493.4 1486.97" fill="none" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><path d="M 3493.43 1492.22 L 3489.89 1485.24 L 3493.4 1486.97 L 3496.89 1485.2 Z" fill="#4d4d4d" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><path d="M 3493 1389 L 3553 1416.5 L 3493 1444 L 3433 1416.5 Z" fill="#ff99cc" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="12px"><text x="3491.79" y="1419.29">if (self._handle) </text></g><path d="M 3603 1513.5 L 3666.63 1513.5" fill="none" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><path d="M 3671.88 1513.5 L 3664.88 1517 L 3666.63 1513.5 L 3664.88 1510 Z" fill="#4d4d4d" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><rect x="3383" y="1493.5" width="220" height="40" fill="#ff66b3" stroke="#000000" pointer-events="none"/><g transform="translate(3390.5,1499.5)"><foreignObject style="overflow:visible;" pointer-events="all" width="203" height="26"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 205px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;"><span style="text-align: left ; white-space: nowrap">self._handle.onread = onStreamRead;<br/></span><span style="text-align: left">添加 onStreamRead<br/></span></div></div></foreignObject></g><path d="M 3893 1513.84 L 3936.63 1513.98" fill="none" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><path d="M 3941.88 1514 L 3934.87 1517.47 L 3936.63 1513.98 L 3934.89 1510.47 Z" fill="#4d4d4d" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><rect x="3673" y="1493.5" width="220" height="40" fill="#ff99cc" stroke="#000000" pointer-events="none"/><g transform="translate(3713.5,1506.5)"><foreignObject style="overflow:visible;" pointer-events="all" width="137" height="12"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 139px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;"><span style="text-align: left ; white-space: nowrap">result = stream.push(buf);</span><span style="text-align: left"><br/></span></div></div></foreignObject></g><path d="M 4263 1514.5 L 4306.63 1514.5" fill="none" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><path d="M 4311.88 1514.5 L 4304.88 1518 L 4306.63 1514.5 L 4304.88 1511 Z" fill="#4d4d4d" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><rect x="3943" y="1495.5" width="320" height="38" fill="#ff99cc" stroke="#000000" pointer-events="none"/><g transform="translate(3955.5,1507.5)"><foreignObject style="overflow:visible;" pointer-events="all" width="293" height="12"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 295px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;"><span style="text-align: left ; white-space: nowrap">return readableAddChunk(this, chunk, encoding, false);</span><span style="text-align: left"><br/></span></div></div></foreignObject></g><path d="M 4543 1514.5 L 4616.63 1514.5" fill="none" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><path d="M 4621.88 1514.5 L 4614.88 1518 L 4616.63 1514.5 L 4614.88 1511 Z" fill="#4d4d4d" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><rect x="4313" y="1495.5" width="230" height="38" fill="#ff99cc" stroke="#000000" pointer-events="none"/><g transform="translate(4323.5,1507.5)"><foreignObject style="overflow:visible;" pointer-events="all" width="207" height="12"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 207px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;"><span style="text-align: left ; white-space: nowrap">addChunk(stream, state, chunk, false);</span><span style="text-align: left"><br/></span></div></div></foreignObject></g><rect x="4623" y="1495.5" width="170" height="38" fill="#9999ff" stroke="#000000" pointer-events="none"/><g transform="translate(4636.5,1500.5)"><foreignObject style="overflow:visible;" pointer-events="all" width="141" height="26"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(255, 255, 255); line-height: 1.2; vertical-align: top; width: 141px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;"><span style="text-align: left ; white-space: nowrap">stream.emit('data', chunk);<br/></span><span style="text-align: left">发出 data 事件<br/></span></div></div></foreignObject></g><path d="M 3253 1331 L 3253 1392.63" fill="none" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><path d="M 3253 1397.88 L 3249.5 1390.88 L 3253 1392.63 L 3256.5 1390.88 Z" fill="#4d4d4d" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><path d="M 3358 1312.5 L 3431.63 1312.5" fill="none" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><path d="M 3436.88 1312.5 L 3429.88 1316 L 3431.63 1312.5 L 3429.88 1309 Z" fill="#4d4d4d" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><rect x="3148" y="1294" width="210" height="37" fill="#ff66b3" stroke="#000000" pointer-events="none"/><g transform="translate(3150.5,1298.5)"><foreignObject style="overflow:visible;" pointer-events="all" width="203" height="26"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 203px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;"><span style="text-align: left ; white-space: nowrap">this.on('end', onReadableStreamEnd);<br/></span><span style="text-align: left">添加 </span><span style="text-align: left ; white-space: nowrap">onReadableStreamEnd 监听</span><span style="text-align: left"><br/></span></div></div></foreignObject></g><path d="M 3553 1312.5 L 3666.63 1312.5" fill="none" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><path d="M 3671.88 1312.5 L 3664.88 1316 L 3666.63 1312.5 L 3664.88 1309 Z" fill="#4d4d4d" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><rect x="3438" y="1294" width="115" height="37" fill="#ff99cc" stroke="#000000" pointer-events="none"/><g transform="translate(3458.5,1305.5)"><foreignObject style="overflow:visible;" pointer-events="all" width="72" height="12"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 74px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;"><span style="text-align: left ; white-space: nowrap">this.destroy();</span><span style="text-align: left"><br/></span></div></div></foreignObject></g><path d="M 3773 1346 L 3773 1376.63" fill="none" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><path d="M 3773 1381.88 L 3769.5 1374.88 L 3773 1376.63 L 3776.5 1374.88 Z" fill="#4d4d4d" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><rect x="3673" y="1279" width="200" height="67" fill="#9999ff" stroke="#000000" pointer-events="none"/><g transform="translate(3674.5,1284.5)"><foreignObject style="overflow:visible;" pointer-events="all" width="190" height="54"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 191px; white-space: nowrap; overflow-wrap: normal; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;"><span style="white-space: nowrap">this._handle.close(() =&gt; {<br/>      debug('emit close');<br/>      this.emit('close', isException);    <br/>});</span><span><br/></span></div></div></foreignObject></g><rect x="3673" y="1383" width="200" height="67" fill="#ff99cc" stroke="#000000" pointer-events="none"/><g transform="translate(3674.5,1388.5)"><foreignObject style="overflow:visible;" pointer-events="all" width="149" height="54"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 150px; white-space: nowrap; overflow-wrap: normal; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;"><span style="white-space: nowrap">this._handle.onread = noop;<br/>this._handle = null;<br/>this._sockname = null;<br/></span><span>做内存回收<br/></span></div></div></foreignObject></g><path d="M 3499.57 386.5 L 3573.2 386.5" fill="none" stroke="#4d4d4d" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="none"/><path d="M 3578.45 386.5 L 3571.45 390 L 3573.2 386.5 L 3571.45 383 Z" fill="#4d4d4d" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><path d="M 3419.57 411.5 L 3419.57 479.13" fill="none" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><path d="M 3419.57 484.38 L 3416.07 477.38 L 3419.57 479.13 L 3423.07 477.38 Z" fill="#4d4d4d" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><path d="M 3339.57 361.5 L 3499.57 361.5 L 3499.57 411.5 L 3339.57 411.5 L 3339.57 361.5 Z" fill="#ffff99" stroke="none" pointer-events="none"/><path d="M 3346.24 365.67 L 3346.24 407.33 L 3346.24 407.33 L 3492.9 407.33 L 3492.9 365.67 L 3346.24 365.67" fill="#ffff99" stroke="none" pointer-events="none"/><path d="M 3339.57 361.5 L 3499.57 361.5 L 3499.57 411.5 L 3339.57 411.5 L 3339.57 361.5 Z" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="12px"><text x="3418.36" y="389.29">onStreamRead()</text></g><path d="M 3419.57 535.5 L 3419.57 580.63" fill="none" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><path d="M 3419.57 585.88 L 3416.07 578.88 L 3419.57 580.63 L 3423.07 578.88 Z" fill="#4d4d4d" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><path d="M 3499.57 510.5 L 3573.2 510.5" fill="none" stroke="#4d4d4d" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="none"/><path d="M 3578.45 510.5 L 3571.45 514 L 3573.2 510.5 L 3571.45 507 Z" fill="#4d4d4d" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><path d="M 3339.57 485.5 L 3499.57 485.5 L 3499.57 535.5 L 3339.57 535.5 L 3339.57 485.5 Z" fill="#ffff99" stroke="none" pointer-events="none"/><path d="M 3346.24 489.67 L 3346.24 531.33 L 3346.24 531.33 L 3492.9 531.33 L 3492.9 489.67 L 3346.24 489.67" fill="#ffff99" stroke="none" pointer-events="none"/><path d="M 3339.57 485.5 L 3499.57 485.5 L 3499.57 535.5 L 3339.57 535.5 L 3339.57 485.5 Z" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="12px"><text x="3418.36" y="513.29">onReadableStreamEnd()</text></g><path d="M 3739.57 510.5 L 3813.2 510.5" fill="none" stroke="#4d4d4d" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="none"/><path d="M 3818.45 510.5 L 3811.45 514 L 3813.2 510.5 L 3811.45 507 Z" fill="#4d4d4d" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><path d="M 3579.57 485.5 L 3739.57 485.5 L 3739.57 535.5 L 3579.57 535.5 L 3579.57 485.5 Z" fill="#ffff99" stroke="none" pointer-events="none"/><path d="M 3586.24 489.67 L 3586.24 531.33 L 3586.24 531.33 L 3732.9 531.33 L 3732.9 489.67 L 3586.24 489.67" fill="#ffff99" stroke="none" pointer-events="none"/><path d="M 3579.57 485.5 L 3739.57 485.5 L 3739.57 535.5 L 3579.57 535.5 L 3579.57 485.5 Z" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="12px"><text x="3658.36" y="513.29">onReadableStreamEnd()</text></g><path d="M 3819.57 485.5 L 3979.57 485.5 L 3979.57 535.5 L 3819.57 535.5 L 3819.57 485.5 Z" fill="#ffff99" stroke="none" pointer-events="none"/><path d="M 3826.24 489.67 L 3826.24 531.33 L 3826.24 531.33 L 3972.9 531.33 L 3972.9 489.67 L 3826.24 489.67" fill="#ffff99" stroke="none" pointer-events="none"/><path d="M 3819.57 485.5 L 3979.57 485.5 L 3979.57 535.5 L 3819.57 535.5 L 3819.57 485.5 Z" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="12px"><text x="3898.36" y="513.29">onReadableStreamEnd()</text></g><path d="M 3499.57 612 L 3573.2 612" fill="none" stroke="#4d4d4d" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="none"/><path d="M 3578.45 612 L 3571.45 615.5 L 3573.2 612 L 3571.45 608.5 Z" fill="#4d4d4d" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><path d="M 3419.33 637 L 3418.85 687.63" fill="none" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><path d="M 3418.8 692.88 L 3415.37 685.85 L 3418.85 687.63 L 3422.37 685.92 Z" fill="#4d4d4d" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><path d="M 3339.57 587 L 3499.57 587 L 3499.57 637 L 3339.57 637 L 3339.57 587 Z" fill="#ffff99" stroke="none" pointer-events="none"/><path d="M 3346.24 591.17 L 3346.24 632.83 L 3346.24 632.83 L 3492.9 632.83 L 3492.9 591.17 L 3346.24 591.17" fill="#ffff99" stroke="none" pointer-events="none"/><path d="M 3339.57 587 L 3499.57 587 L 3499.57 637 L 3339.57 637 L 3339.57 587 Z" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="12px"><text x="3418.36" y="614.79">this._handle.onexit()</text></g><path d="M 3739.57 612 L 3813.2 612" fill="none" stroke="#4d4d4d" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="none"/><path d="M 3818.45 612 L 3811.45 615.5 L 3813.2 612 L 3811.45 608.5 Z" fill="#4d4d4d" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><path d="M 3579.57 587 L 3739.57 587 L 3739.57 637 L 3579.57 637 L 3579.57 587 Z" fill="#ffff99" stroke="none" pointer-events="none"/><path d="M 3586.24 591.17 L 3586.24 632.83 L 3586.24 632.83 L 3732.9 632.83 L 3732.9 591.17 L 3586.24 591.17" fill="#ffff99" stroke="none" pointer-events="none"/><path d="M 3579.57 587 L 3739.57 587 L 3739.57 637 L 3579.57 637 L 3579.57 587 Z" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="12px"><text x="3658.36" y="607.79">this.stdin.destroy();</text><text x="3658.36" y="621.79">关闭输入流</text></g><path d="M 3819.57 587 L 3979.57 587 L 3979.57 637 L 3819.57 637 L 3819.57 587 Z" fill="#ffff99" stroke="none" pointer-events="none"/><path d="M 3826.24 591.17 L 3826.24 632.83 L 3826.24 632.83 L 3972.9 632.83 L 3972.9 591.17 L 3826.24 591.17" fill="#ffff99" stroke="none" pointer-events="none"/><path d="M 3819.57 587 L 3979.57 587 L 3979.57 637 L 3819.57 637 L 3819.57 587 Z" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="12px"><text x="3898.36" y="607.79">this.emit('exit',);</text><text x="3898.36" y="621.79">关闭子进程</text></g><g transform="translate(3664.5,163.5)"><foreignObject style="overflow:visible;" pointer-events="all" width="64" height="17"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 16px; font-family: Helvetica; color: rgb(26, 26, 26); line-height: 1.2; vertical-align: top; white-space: nowrap; font-weight: bold; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">异步回调</div></div></foreignObject></g><path d="M 3497.57 716.68 L 3573.2 715.89" fill="none" stroke="#4d4d4d" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="none"/><path d="M 3578.45 715.83 L 3571.49 719.4 L 3573.2 715.89 L 3571.42 712.4 Z" fill="#4d4d4d" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><path d="M 3339.57 694 L 3497.57 694 L 3497.57 741 L 3339.57 741 L 3339.57 694 Z" fill="#ffff99" stroke="none" pointer-events="none"/><path d="M 3346.15 697.92 L 3346.15 737.08 L 3346.15 737.08 L 3490.99 737.08 L 3490.99 697.92 L 3346.15 697.92" fill="#ffff99" stroke="none" pointer-events="none"/><path d="M 3339.57 694 L 3497.57 694 L 3497.57 741 L 3339.57 741 L 3339.57 694 Z" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="12px"><text x="3417.36" y="720.29">3个流的 close 事件依次触发</text></g><path d="M 3736.57 714.51 L 3813.2 714.03" fill="none" stroke="#4d4d4d" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="none"/><path d="M 3818.45 714 L 3811.48 717.54 L 3813.2 714.03 L 3811.43 710.54 Z" fill="#4d4d4d" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><path d="M 3579.57 690 L 3736.57 690 L 3736.57 740 L 3579.57 740 L 3579.57 690 Z" fill="#ffff99" stroke="none" pointer-events="none"/><path d="M 3586.11 694.17 L 3586.11 735.83 L 3586.11 735.83 L 3730.03 735.83 L 3730.03 694.17 L 3586.11 694.17" fill="#ffff99" stroke="none" pointer-events="none"/><path d="M 3579.57 690 L 3736.57 690 L 3736.57 740 L 3579.57 740 L 3579.57 690 Z" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="12px"><text x="3656.86" y="710.79">exithandler()</text><text x="3656.86" y="724.79">处理 输出流 和 错误流信息</text></g><path d="M 3819.57 687 L 3977.57 687 L 3977.57 740 L 3819.57 740 L 3819.57 687 Z" fill="#ffff99" stroke="none" pointer-events="none"/><path d="M 3826.15 691.42 L 3826.15 735.58 L 3826.15 735.58 L 3970.99 735.58 L 3970.99 691.42 L 3826.15 691.42" fill="#ffff99" stroke="none" pointer-events="none"/><path d="M 3819.57 687 L 3977.57 687 L 3977.57 740 L 3819.57 740 L 3819.57 687 Z" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="12px"><text x="3897.36" y="709.29">callback(ex, stdout, stderr)</text><text x="3897.36" y="723.29">调用用户回调</text></g><path d="M 4367.07 406.5 L 4367.07 443.13" fill="none" stroke="#4d4d4d" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="none"/><path d="M 4367.07 448.38 L 4363.57 441.38 L 4367.07 443.13 L 4370.57 441.38 Z" fill="#4d4d4d" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><path d="M 4297.07 346.5 L 4437.07 346.5 L 4437.07 406.5 L 4297.07 406.5 L 4297.07 346.5 Z" fill="#cc99ff" stroke="none" pointer-events="none"/><path d="M 4302.9 351.5 L 4302.9 401.5 L 4302.9 401.5 L 4431.24 401.5 L 4431.24 351.5 L 4302.9 351.5" fill="#cc99ff" stroke="none" pointer-events="none"/><path d="M 4297.07 346.5 L 4437.07 346.5 L 4437.07 406.5 L 4297.07 406.5 L 4297.07 346.5 Z" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="12px"><text x="4365.86" y="379.29">错误流关闭</text></g><path d="M 4367.07 509.5 L 4367.07 558.63" fill="none" stroke="#4d4d4d" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="none"/><path d="M 4367.07 563.88 L 4363.57 556.88 L 4367.07 558.63 L 4370.57 556.88 Z" fill="#4d4d4d" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><path d="M 4297.07 449.5 L 4437.07 449.5 L 4437.07 509.5 L 4297.07 509.5 L 4297.07 449.5 Z" fill="#cc99ff" stroke="none" pointer-events="none"/><path d="M 4302.9 454.5 L 4302.9 504.5 L 4302.9 504.5 L 4431.24 504.5 L 4431.24 454.5 L 4302.9 454.5" fill="#cc99ff" stroke="none" pointer-events="none"/><path d="M 4297.07 449.5 L 4437.07 449.5 L 4437.07 509.5 L 4297.07 509.5 L 4297.07 449.5 Z" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="12px"><text x="4365.86" y="482.29">输入流关闭</text></g><path d="M 4367.07 726.5 L 4367.07 770.13" fill="none" stroke="#4d4d4d" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="none"/><path d="M 4367.07 775.38 L 4363.57 768.38 L 4367.07 770.13 L 4370.57 768.38 Z" fill="#4d4d4d" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><path d="M 4297.07 666.5 L 4437.07 666.5 L 4437.07 726.5 L 4297.07 726.5 L 4297.07 666.5 Z" fill="#ffff99" stroke="none" pointer-events="none"/><path d="M 4302.9 671.5 L 4302.9 721.5 L 4302.9 721.5 L 4431.24 721.5 L 4431.24 671.5 L 4302.9 671.5" fill="#ffff99" stroke="none" pointer-events="none"/><path d="M 4297.07 666.5 L 4437.07 666.5 L 4437.07 726.5 L 4297.07 726.5 L 4297.07 666.5 Z" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="12px"><text x="4365.86" y="699.29">close() -&gt; callbakc()</text></g><path d="M 4367.07 836.5 L 4367.07 880.13" fill="none" stroke="#4d4d4d" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="none"/><path d="M 4367.07 885.38 L 4363.57 878.38 L 4367.07 880.13 L 4370.57 878.38 Z" fill="#4d4d4d" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><path d="M 4297.07 776.5 L 4437.07 776.5 L 4437.07 836.5 L 4297.07 836.5 L 4297.07 776.5 Z" fill="#ff6666" stroke="none" pointer-events="none"/><path d="M 4302.9 781.5 L 4302.9 831.5 L 4302.9 831.5 L 4431.24 831.5 L 4431.24 781.5 L 4302.9 781.5" fill="#ff6666" stroke="none" pointer-events="none"/><path d="M 4297.07 776.5 L 4437.07 776.5 L 4437.07 836.5 L 4297.07 836.5 L 4297.07 776.5 Z" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="12px"><text x="4365.86" y="809.29">子进程 close</text></g><path d="M 4297.07 886.5 L 4437.07 886.5 L 4437.07 946.5 L 4297.07 946.5 L 4297.07 886.5 Z" fill="#cc99ff" stroke="none" pointer-events="none"/><path d="M 4302.9 891.5 L 4302.9 941.5 L 4302.9 941.5 L 4431.24 941.5 L 4431.24 891.5 L 4302.9 891.5" fill="#cc99ff" stroke="none" pointer-events="none"/><path d="M 4297.07 886.5 L 4437.07 886.5 L 4437.07 946.5 L 4297.07 946.5 L 4297.07 886.5 Z" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="12px"><text x="4365.86" y="919.29">输出流 close</text></g><path d="M 4367.07 306.5 L 4367.07 340.13" fill="none" stroke="#4d4d4d" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="none"/><path d="M 4367.07 345.38 L 4363.57 338.38 L 4367.07 340.13 L 4370.57 338.38 Z" fill="#4d4d4d" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><path d="M 4297.07 246.5 L 4437.07 246.5 L 4437.07 306.5 L 4297.07 306.5 L 4297.07 246.5 Z" fill="#ff6666" stroke="none" pointer-events="none"/><path d="M 4302.9 251.5 L 4302.9 301.5 L 4302.9 301.5 L 4431.24 301.5 L 4431.24 251.5 L 4302.9 251.5" fill="#ff6666" stroke="none" pointer-events="none"/><path d="M 4297.07 246.5 L 4437.07 246.5 L 4437.07 306.5 L 4297.07 306.5 L 4297.07 246.5 Z" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="12px"><text x="4365.86" y="279.29">子进程exit关闭</text></g><path d="M 4367.07 206.5 L 4367.07 240.13" fill="none" stroke="#4d4d4d" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="none"/><path d="M 4367.07 245.38 L 4363.57 238.38 L 4367.07 240.13 L 4370.57 238.38 Z" fill="#4d4d4d" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><path d="M 4297.07 146.5 L 4437.07 146.5 L 4437.07 206.5 L 4297.07 206.5 L 4297.07 146.5 Z" fill="#ffff99" stroke="none" pointer-events="none"/><path d="M 4302.9 151.5 L 4302.9 201.5 L 4302.9 201.5 L 4431.24 201.5 L 4431.24 151.5 L 4302.9 151.5" fill="#ffff99" stroke="none" pointer-events="none"/><path d="M 4297.07 146.5 L 4437.07 146.5 L 4437.07 206.5 L 4297.07 206.5 L 4297.07 146.5 Z" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="12px"><text x="4365.86" y="179.29">输出流 data 事件</text></g><path d="M 4664.57 406.5 L 4664.57 443.13" fill="none" stroke="#4d4d4d" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="none"/><path d="M 4664.57 448.38 L 4661.07 441.38 L 4664.57 443.13 L 4668.07 441.38 Z" fill="#4d4d4d" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><path d="M 4594.57 346.5 L 4734.57 346.5 L 4734.57 406.5 L 4594.57 406.5 L 4594.57 346.5 Z" fill="#cc99ff" stroke="none" pointer-events="none"/><path d="M 4600.4 351.5 L 4600.4 401.5 L 4600.4 401.5 L 4728.74 401.5 L 4728.74 351.5 L 4600.4 351.5" fill="#cc99ff" stroke="none" pointer-events="none"/><path d="M 4594.57 346.5 L 4734.57 346.5 L 4734.57 406.5 L 4594.57 406.5 L 4594.57 346.5 Z" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="12px"><text x="4663.36" y="379.29">输出流关闭</text></g><path d="M 4664.78 509.5 L 4665.09 555.63" fill="none" stroke="#4d4d4d" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="none"/><path d="M 4665.12 560.88 L 4661.58 553.91 L 4665.09 555.63 L 4668.58 553.86 Z" fill="#4d4d4d" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><path d="M 4594.57 449.5 L 4734.57 449.5 L 4734.57 509.5 L 4594.57 509.5 L 4594.57 449.5 Z" fill="#cc99ff" stroke="none" pointer-events="none"/><path d="M 4600.4 454.5 L 4600.4 504.5 L 4600.4 504.5 L 4728.74 504.5 L 4728.74 454.5 L 4600.4 454.5" fill="#cc99ff" stroke="none" pointer-events="none"/><path d="M 4594.57 449.5 L 4734.57 449.5 L 4734.57 509.5 L 4594.57 509.5 L 4594.57 449.5 Z" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="12px"><text x="4663.36" y="482.29">输入流关闭</text></g><path d="M 4663.84 726.5 L 4664.24 770.13" fill="none" stroke="#4d4d4d" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="none"/><path d="M 4664.29 775.38 L 4660.73 768.41 L 4664.24 770.13 L 4667.72 768.35 Z" fill="#4d4d4d" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><path d="M 4593.57 666.5 L 4733.57 666.5 L 4733.57 726.5 L 4593.57 726.5 L 4593.57 666.5 Z" fill="#ffff99" stroke="none" pointer-events="none"/><path d="M 4599.4 671.5 L 4599.4 721.5 L 4599.4 721.5 L 4727.74 721.5 L 4727.74 671.5 L 4599.4 671.5" fill="#ffff99" stroke="none" pointer-events="none"/><path d="M 4593.57 666.5 L 4733.57 666.5 L 4733.57 726.5 L 4593.57 726.5 L 4593.57 666.5 Z" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="12px"><text x="4662.36" y="699.29">close() -&gt; callbakc()</text></g><path d="M 4664.57 836.5 L 4664.57 880.13" fill="none" stroke="#4d4d4d" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="none"/><path d="M 4664.57 885.38 L 4661.07 878.38 L 4664.57 880.13 L 4668.07 878.38 Z" fill="#4d4d4d" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><path d="M 4594.57 776.5 L 4734.57 776.5 L 4734.57 836.5 L 4594.57 836.5 L 4594.57 776.5 Z" fill="#ff6666" stroke="none" pointer-events="none"/><path d="M 4600.4 781.5 L 4600.4 831.5 L 4600.4 831.5 L 4728.74 831.5 L 4728.74 781.5 L 4600.4 781.5" fill="#ff6666" stroke="none" pointer-events="none"/><path d="M 4594.57 776.5 L 4734.57 776.5 L 4734.57 836.5 L 4594.57 836.5 L 4594.57 776.5 Z" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="12px"><text x="4663.36" y="809.29">子进程 close</text></g><path d="M 4594.57 886.5 L 4734.57 886.5 L 4734.57 946.5 L 4594.57 946.5 L 4594.57 886.5 Z" fill="#cc99ff" stroke="none" pointer-events="none"/><path d="M 4600.4 891.5 L 4600.4 941.5 L 4600.4 941.5 L 4728.74 941.5 L 4728.74 891.5 L 4600.4 891.5" fill="#cc99ff" stroke="none" pointer-events="none"/><path d="M 4594.57 886.5 L 4734.57 886.5 L 4734.57 946.5 L 4594.57 946.5 L 4594.57 886.5 Z" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="12px"><text x="4663.36" y="919.29">错误流 close</text></g><path d="M 4664.57 306.5 L 4664.57 340.13" fill="none" stroke="#4d4d4d" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="none"/><path d="M 4664.57 345.38 L 4661.07 338.38 L 4664.57 340.13 L 4668.07 338.38 Z" fill="#4d4d4d" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><path d="M 4594.57 246.5 L 4734.57 246.5 L 4734.57 306.5 L 4594.57 306.5 L 4594.57 246.5 Z" fill="#ff6666" stroke="none" pointer-events="none"/><path d="M 4600.4 251.5 L 4600.4 301.5 L 4600.4 301.5 L 4728.74 301.5 L 4728.74 251.5 L 4600.4 251.5" fill="#ff6666" stroke="none" pointer-events="none"/><path d="M 4594.57 246.5 L 4734.57 246.5 L 4734.57 306.5 L 4594.57 306.5 L 4594.57 246.5 Z" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="12px"><text x="4663.36" y="279.29">子进程exit关闭</text></g><path d="M 4664.57 206.5 L 4664.57 240.13" fill="none" stroke="#4d4d4d" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="none"/><path d="M 4664.57 245.38 L 4661.07 238.38 L 4664.57 240.13 L 4668.07 238.38 Z" fill="#4d4d4d" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><path d="M 4594.57 146.5 L 4734.57 146.5 L 4734.57 206.5 L 4594.57 206.5 L 4594.57 146.5 Z" fill="#ffff99" stroke="none" pointer-events="none"/><path d="M 4600.4 151.5 L 4600.4 201.5 L 4600.4 201.5 L 4728.74 201.5 L 4728.74 151.5 L 4600.4 151.5" fill="#ffff99" stroke="none" pointer-events="none"/><path d="M 4594.57 146.5 L 4734.57 146.5 L 4734.57 206.5 L 4594.57 206.5 L 4594.57 146.5 Z" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="12px"><text x="4663.36" y="179.29">错误流 data 事件</text></g><g transform="translate(4334.5,102.5)"><foreignObject style="overflow:visible;" pointer-events="all" width="64" height="17"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 16px; font-family: Helvetica; color: rgb(26, 26, 26); line-height: 1.2; vertical-align: top; white-space: nowrap; font-weight: bold; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">正常流程</div></div></foreignObject></g><g transform="translate(4628.5,102.5)"><foreignObject style="overflow:visible;" pointer-events="all" width="64" height="17"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 16px; font-family: Helvetica; color: rgb(26, 26, 26); line-height: 1.2; vertical-align: top; white-space: nowrap; font-weight: bold; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">报错流程</div></div></foreignObject></g><path d="M 3820.07 399 L 3978.07 399 L 3978.07 438 L 3820.07 438 L 3820.07 399 Z" fill="#ffff99" stroke="none" pointer-events="none"/><path d="M 3826.65 402.25 L 3826.65 434.75 L 3826.65 434.75 L 3971.49 434.75 L 3971.49 402.25 L 3826.65 402.25" fill="#ffff99" stroke="none" pointer-events="none"/><path d="M 3820.07 399 L 3978.07 399 L 3978.07 438 L 3820.07 438 L 3820.07 399 Z" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="12px"><text x="3897.86" y="421.29">stderr.on('data')</text></g><path d="M 4367.07 625 L 4367.07 660.13" fill="none" stroke="#4d4d4d" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="none"/><path d="M 4367.07 665.38 L 4363.57 658.38 L 4367.07 660.13 L 4370.57 658.38 Z" fill="#4d4d4d" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><path d="M 4297.07 565 L 4437.07 565 L 4437.07 625 L 4297.07 625 L 4297.07 565 Z" fill="#ffff99" stroke="none" pointer-events="none"/><path d="M 4302.9 570 L 4302.9 620 L 4302.9 620 L 4431.24 620 L 4431.24 570 L 4302.9 570" fill="#ffff99" stroke="none" pointer-events="none"/><path d="M 4297.07 565 L 4437.07 565 L 4437.07 625 L 4297.07 625 L 4297.07 565 Z" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="12px"><text x="4365.86" y="590.79">subprocess.emit('close')</text><text x="4365.86" y="604.79">所有子进程关闭</text></g><path d="M 4664.28 625 L 4663.93 660.13" fill="none" stroke="#4d4d4d" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="none"/><path d="M 4663.88 665.38 L 4660.45 658.35 L 4663.93 660.13 L 4667.45 658.42 Z" fill="#4d4d4d" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><path d="M 4594.57 565 L 4734.57 565 L 4734.57 625 L 4594.57 625 L 4594.57 565 Z" fill="#ffff99" stroke="none" pointer-events="none"/><path d="M 4600.4 570 L 4600.4 620 L 4600.4 620 L 4728.74 620 L 4728.74 570 L 4600.4 570" fill="#ffff99" stroke="none" pointer-events="none"/><path d="M 4594.57 565 L 4734.57 565 L 4734.57 625 L 4594.57 625 L 4594.57 565 Z" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="12px"><text x="4663.36" y="590.79">subprocess.emit('close')</text><text x="4663.36" y="604.79">所有子进程关闭</text></g><path d="M 2535 162 L 2535 235.63" fill="none" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><path d="M 2535 240.88 L 2531.5 233.88 L 2535 235.63 L 2538.5 233.88 Z" fill="#4d4d4d" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><path d="M 2435 109 L 2635 109 L 2635 162 L 2435 162 L 2435 109 Z" fill="#ffff66" stroke="none" pointer-events="none"/><path d="M 2443.33 113.42 L 2443.33 157.58 L 2443.33 157.58 L 2626.67 157.58 L 2626.67 113.42 L 2443.33 113.42" fill="#ffff66" stroke="none" pointer-events="none"/><path d="M 2435 109 L 2635 109 L 2635 162 L 2435 162 L 2435 109 Z" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="12px"><text x="2533.79" y="138.29">function maybeClose(subprocess) </text></g><path d="M 2535 295 L 2535 332.63" fill="none" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><path d="M 2535 337.88 L 2531.5 330.88 L 2535 332.63 L 2538.5 330.88 Z" fill="#4d4d4d" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><path d="M 2435 242 L 2635 242 L 2635 295 L 2435 295 L 2435 242 Z" fill="#ffffff" stroke="none" pointer-events="none"/><path d="M 2443.33 246.42 L 2443.33 290.58 L 2443.33 290.58 L 2626.67 290.58 L 2626.67 246.42 L 2443.33 246.42" fill="#ffffff" stroke="none" pointer-events="none"/><path d="M 2435 242 L 2635 242 L 2635 295 L 2435 295 L 2435 242 Z" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="12px"><text x="2533.79" y="271.29">subprocess._closesGot++;</text></g><path d="M 2535 392 L 2535 445.63" fill="none" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><path d="M 2535 450.88 L 2531.5 443.88 L 2535 445.63 L 2538.5 443.88 Z" fill="#4d4d4d" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(2493.5,415.5)"><foreignObject style="overflow:visible;" pointer-events="all" width="83" height="12"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 11px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; white-space: nowrap; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;background-color:#ffffff;">发出 close 事件</div></div></foreignObject></g><path d="M 2535 339 L 2615 365.5 L 2535 392 L 2455 365.5 Z" fill="#ffffff" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="12px"><text x="2533.79" y="368.29">需要关闭的流是否达到</text></g><path d="M 2458 452 L 2612 452 L 2612 532 L 2458 532 L 2458 452 Z" fill="#9999ff" stroke="none" pointer-events="none"/><path d="M 2464.42 458.67 L 2464.42 525.33 L 2464.42 525.33 L 2605.58 525.33 L 2605.58 458.67 L 2464.42 458.67" fill="#9999ff" stroke="none" pointer-events="none"/><path d="M 2458 452 L 2612 452 L 2612 532 L 2458 532 L 2458 452 Z" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g fill="#000000" font-family="Helvetica" font-size="12px"><text x="2459.5" y="466.79">subprocess.emit(</text><text x="2459.5" y="480.79">    'close', </text><text x="2459.5" y="494.79">    subprocess.exitCode, </text><text x="2459.5" y="508.79">    subprocess.signalCode</text><text x="2459.5" y="522.79">);</text></g><rect x="653" y="249" width="382" height="130" fill="none" stroke="#666666" stroke-dasharray="3 3" pointer-events="none"/><g transform="translate(654.5,250.5)"><foreignObject style="overflow:visible;" pointer-events="all" width="372" height="124"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(26, 26, 26); line-height: 1.2; vertical-align: top; white-space: nowrap; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">const child = spawn(file, args, {<br/>    cwd: options.cwd, <br/>    env: options.env, <br/>    gid: options.gid, <br/>    uid: options.uid, <br/>    shell: options.shell, <br/>    windowsHide: !!options.windowsHide, <br/>    windowsVerbatimArguments: !!options.windowsVerbatimArguments <br/>});</div></div></foreignObject></g><path d="M 500.97 431 Q 520 348 558.5 316.5 Q 597 285 642.86 279.3" fill="none" stroke="#4d4d4d" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="none"/><path d="M 648.07 278.65 L 641.56 282.99 L 642.86 279.3 L 640.69 276.04 Z" fill="#4d4d4d" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><path d="M 443 1043 L 443 1092.63" fill="none" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><path d="M 443 1097.88 L 439.5 1090.88 L 443 1092.63 L 446.5 1090.88 Z" fill="#4d4d4d" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><rect x="382" y="999" width="122" height="44" fill="#9999ff" stroke="#000000" pointer-events="none"/><g transform="translate(400.5,1013.5)"><foreignObject style="overflow:visible;" pointer-events="all" width="83" height="12"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 83px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">添加 close 监听<br/></div></div></foreignObject></g><path d="M 443 1154 L 443 1195.63" fill="none" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><path d="M 443 1200.88 L 439.5 1193.88 L 443 1195.63 L 446.5 1193.88 Z" fill="#4d4d4d" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><rect x="378" y="1099" width="130" height="55" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(381.5,1112.5)"><foreignObject style="overflow:visible;" pointer-events="all" width="121" height="26"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 121px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;"><span style="color: rgb(26 , 26 , 26) ; text-align: left">stdout = _stdout.join('')<br/>取到所有 输出流<br/></span></div></div></foreignObject></g><path d="M 443.12 1257 L 443.33 1303.63" fill="none" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><path d="M 443.35 1308.88 L 439.82 1301.9 L 443.33 1303.63 L 446.82 1301.87 Z" fill="#4d4d4d" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><rect x="378" y="1202" width="130" height="55" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(382.5,1215.5)"><foreignObject style="overflow:visible;" pointer-events="all" width="119" height="26"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 119px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;"><span style="color: rgb(26 , 26 , 26) ; text-align: left ; white-space: nowrap">stderr = _stderr.join('');<br/></span><span style="color: rgb(26 , 26 , 26) ; text-align: left">取到所有 错误流<br/></span></div></div></foreignObject></g><path d="M 443.5 1373 L 295.73 1449.08" fill="none" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><path d="M 291.07 1451.48 L 295.69 1445.16 L 295.73 1449.08 L 298.89 1451.39 Z" fill="#4d4d4d" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(342.5,1405.5)"><foreignObject style="overflow:visible;" pointer-events="all" width="48" height="12"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(26, 26, 26); line-height: 1.2; vertical-align: top; white-space: nowrap; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;background-color:#ffffff;">没有错误</div></div></foreignObject></g><path d="M 445.92 1374.01 L 616.66 1451.18" fill="none" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><path d="M 621.45 1453.34 L 613.63 1453.65 L 616.66 1451.18 L 616.51 1447.27 Z" fill="#4d4d4d" stroke="#4d4d4d" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(506.5,1404.5)"><foreignObject style="overflow:visible;" pointer-events="all" width="36" height="12"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(26, 26, 26); line-height: 1.2; vertical-align: top; white-space: nowrap; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;background-color:#ffffff;">有错误</div></div></foreignObject></g><path d="M 443.5 1310 L 530 1341.5 L 443.5 1373 L 357 1341.5 Z" fill="#ffffff" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="12px"><text x="442.29" y="1337.29">if (!ex &amp;&amp; code === 0 )</text><text x="442.29" y="1351.29">判断是否发生错误</text></g><path d="M 185 1451 L 364 1451 L 364 1496 L 185 1496 L 185 1451 Z" fill="#ccff99" stroke="none" pointer-events="none"/><path d="M 192.46 1454.75 L 192.46 1492.25 L 192.46 1492.25 L 356.54 1492.25 L 356.54 1454.75 L 192.46 1454.75" fill="#ccff99" stroke="none" pointer-events="none"/><path d="M 185 1451 L 364 1451 L 364 1496 L 185 1496 L 185 1451 Z" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="12px"><text x="273.29" y="1469.29">callback(null, stdout, stderr);</text><text x="273.29" y="1483.29">执行开发者的回调</text></g><path d="M 499 1451 L 810 1451 L 810 1501 L 499 1501 L 499 1451 Z" fill="#ccff99" stroke="none" pointer-events="none"/><path d="M 511.96 1455.17 L 511.96 1496.83 L 511.96 1496.83 L 797.04 1496.83 L 797.04 1455.17 L 511.96 1455.17" fill="#ccff99" stroke="none" pointer-events="none"/><path d="M 499 1451 L 810 1451 L 810 1501 L 499 1501 L 499 1451 Z" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g fill="#000000" font-family="Helvetica" font-size="12px"><text x="502.5" y="1464.79">ex = new Error('Command failed: ' + cmd + '\n' + stderr);</text><text x="502.5" y="1478.79">callback(ex, stdout, stderr);</text><text x="502.5" y="1492.79">执行开发者的回调</text></g></g></svg>