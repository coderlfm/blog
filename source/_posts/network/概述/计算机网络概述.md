---
title: 计算机网络 计算机网络的概述
date: 2021-03-21 14:10:54
toc: true
tags:
  - Internet

categories:
  - Internet

cover: http://qiniu-oss.liufengmao.cn/blog/cover-imgs/web-1.jpg
---

计算机网络的基本概念

<!-- more -->

<!-- ## 计算机网络的概述 -->

## 熟知的几种网络

- 电信网络
  早期是向用户提供电话，电报以及传真服务的
- 有线电视
  有线电视很明显是向用户传输电视节目

- 计算机网络
  计算机网络主要侧重于用户在计算机中之间传送数据

<article class="message is-info">
  <div class="message-header">
    <p>Internet</p>
  </div>
  <div class="message-body">
   Internet 中文翻译并不统一，现有的 Internet 有两种：
   <br/><br/>

   <li><b>因特网,</b> 全国科学技术名词审定委员会推荐的译名，这个译名较为准确，但是却一直没有推广开来，在 《计算机网络》 第七版 之前都是采用的这个译名 </li>
   <br/>

   <li><b>互联网, </b> 是当前最流行，使用量最广的标准译名，国内各种报刊杂志，电视节目，包括政府文件都使用的是该译名，
   <p>这个译名也更加能体现出 <b>Internet 是有数量极大地计算机网络互相连接起来的</b></p> 
   </li>
  </div>
</article>
<br/>

## 互连网 与 互联网

理解 `互连网` 与 `互联网`

- `互连网 (internet)`: 是一个通用名词，泛指任意使用不同协议将局部范围内的计算机连接掐里的网络称之为互连网
- `互联网 (Internet)`: 是一个专用名词，是值全球最大的，开放的，由众多网络相互连接而成的特定的计算机网络，采用 TCP/IP 协议 作为通信的规则
  <br/>
  <br/>

## 互连网标准化工作

标准化工作对一项技术的发展有着至关重要的影响，
制定的过早可能会由于还未发展到成熟阶段，陈旧的标准可能会限制产品的技术水平，最终不得不重新制定标准
制定的太晚的话，技术的发展可能会五站可循，各家产品制造出来后互不兼容

互联网的标准很大的特点是面向公众，互联网的 所有 RFC 都可以从互联网上下载下来，我们每个人都可以针对某个文档发表自己的意见

<!-- 标准不能制定的过早或者过晚，例如华为5g领先，但不是说全部按照华为的标准 -->

### 正式标准的阶段

- 草案 6 个月
- 建议标准
- 互联网标准 可以获得一个 编号 STD ，一个标准可以有多个 RFC
  <br/>
  <br/>

## 互联网边缘部分的连接方式

### 1.客户端-服务器方式 C/S 服务

这种方式是互联网是最多的
客户端 - 服务端
简单的描述就是 客户端发送请求 -> 服务端做出响应

### 2.对等方式 p2p 方式

简单的讲就是指两台主机在通信时没有明显的区分哪一台是服务端，哪一天是客户端，只要两台主机都运行了对等链接软件(P2P 软件)，它们就可以进行平等的，对等的连接通信，两台主机都能够互相下载对方的共享文件

从本质上来看，对等连接仍然可以看到 客户端-服务端的方式，只是对等链接中，每一台主机都可以是客户端，又可以是服务器

比较典型的例子就是文件下载，我为人人，人人为我的方式

## 互联网的核心部分

- <b>电路交换</b>
  电话机就是典型的 电路交换

  两台电话建立连接需要经过 <b>建立连接(占用通信资源)</b> -> <b>通话(一直占用通信资源)</b> -> <b>释放连接(归还通信资源)</b>
  不同电话通信一对一的线 -> 交换机（通先前需要建立连接） 会存在占线

  当两端的电话一接通，就会建立一条专用的物理通路，这条连接保证了双方通话所需的通信资源，而这些资源在双方通信时不会被其他用户占用，通话完挂机后，交换机才会释放这条专用的物理通路

  老式交换机的是需要人工转接，我们有时候在电视中看到的90年代背景的电视剧中就会出现人工转接的情况，而且长途通话需要通过多个交换机来转接
  如果发送大量的连续的数据，使用电路交换比较快，但是电路交换不适合计算机通信

<br/>

- <b>分组交换</b> 计算机通讯使用的是 分组交换

  在分组交换中，数据(通常一整块数据我们会称为 <b>`报文`</b>)会被分割成一个个等长的分组(数据段, 也被称为包) ，然后给这些分组加上一些必要的控制信息 `(header)`，这样就构成了一个 <b>`分组(packet)`</b>

  这个 `header` 是极极其重要的，正是因为加上了 `header，才能保证每个分组能够在互联网中独立的选择传输的路径，正确的被传输到分组传输的终点`

  分组会发送到就近的路由中 该路由会暂时先存储(这一步路由器是存在内存中而不是硬盘中，所有交换速率是较快的)，`然后会先检查其首部(header)`, 按照首部中的目标地址，接着查找转发表，找个合适的接口转发，交个下一个路由器，这样一步一步(这个过程中有时候回经过十几个不同的路由器)，采用存储转发的方式，最终到达目标主机中，
  
  其中当某个路由器 接受到的信息量过大的时候，它会同时匹配其它的路由帮助转发

  采用 分组交换 不需要 建立连接 - 释放连接 的过程，而且在传送数据时，是不需要占用这个端到另一个端的整个通信资源的，只有在分组在发送到这个路由器的时候，这个链路才是被占用的，在不被占用的时候，这个路由器也是可以为其它分组来提供存储转发的服务的
  
  在网络的中心部分 <b>路由之间的连接是采用 高速链路连接的，数据的 `发送速度` 是极快的，</b> 只有边缘主机和路由核心部分的这块采用的低速链路连接的

  这一步为了保障数据的可靠传输型，当网络中的某些结点或者链路出现故障时，互联网还做了专门的措施，这一块可以后面再讨论

  <b>其中最主要明确：</b>
  分组交换最主要使用的是 `存储转发`
  路由器：最主要是做转发分组的
  
  <b>优点：</b>
    + `高效：`在传输过程中动态分配传输带宽，对通信链路是逐段占用的，而不是整个端占用
    + `灵活：`为每个分组独立的选择最合适的转发路由
    + `迅速：`以分组为单位，不需要先建立连接，就可以向其它主机发送分组
    + `可靠：`保证可靠的网络协议，分布式多路由的分组交换网

 <b>缺点：</b>
    + 在各个路由器中存储转发的过程中需要排队
    + 各个分组必须携带控制信息也会造成一定的开销
<!-- 优点
由于一个分组的长度往往远小于整个报文的长度，因此分组交换比报文交换的时延小，同时也具有更好的灵活性 -->

<br/>

- <b>报文交换</b>
  以前的电报通信用的就是 报文交换 ，报文交换的时延较长，现在使用的较少了

{% asset_img 计算机核心部分的三种交换.png %}

<br/>
<br/>

## 计算机网络的定义
<b>计算机网络的精确定义并未统一</b>
当前对于计算机网络较好的定义是这样的：计算机网络主要是由一些通用的，可编程的硬件互连而成的，而这些硬件并非专门用来实现某一特定目的（例如，传送数据或视频信号）。这些可编程的硬件能够用来传送多种不同类型的数据，并能支撑广泛的和日益增长的应用

根据这个定义：
+ 计算机网络所连接的硬件并不一定是计算机，包括智能手机等，
+ 计算机网络并非专门用来传输数据，而是能够支持很多种应用（包括今后可能出现的各种应用）

## 计算机网络的类别

### 按照作用范围分类

+ `广域网 WAN：` 作用范围是几十到几千公里，主要是通过长距离运送不同主句发送的数据（例如：跨国家）
+ `城域网 MAN：` 作用范围是5 ~ 50 km，通常作用于城市，可以跨域几个街区，甚至整个城市
+ `局域网 LAN：` 地理作用范围较小1km左右，一般是计算机或者工作照通过高速通信线路相连，如果有多个互连的局域网连接在一起，（例如：学校，企业，这样的网络我们称为 <b>校园网</b> 或 <b>企业网</b>）
+ `个人局域网 PAN：` 作用范围很小 10m 左右，指在个人工作的地方把属于个人的电子设备用无线连接起来的网络

### 按照网络的使用者来分类

+ 公用网 (public network) 指电信公司建造的大型网络，所有愿意按照电信公司规定缴纳费用的人都可以使用这种网络
+ 专用网(private network) 是为某些特殊的业务工作建立的专用网络，例如（军队，银行，铁路，电力）等，均有自己系统的专用网

<br/>

## 计算机网络的性能
计算机网络的性能特征一般是指 计算机网络中的几个性能指标，但除了这几个性能指标，一些非性能指标也会对计算机网络的性能产生影响

### 计算机网络的性能指标

+ 速率
+ 带宽
+ 时延
  - 发送时延 
    指 数据的头部从开始发送到将整个尾部完全发送完的时间
    
  - 传播时延
    指 从 数据的尾部 开始 到 数据的尾部完整的进入到 路由器的缓存中的时间
    
  - 处理时延
    指 路由器 在检查 分组 头部信息，检查路由表，分配合适接口的这段时间

  - 排队时延
    指 数据 进入 路由器缓存中的排队时间，以及路由器处理完后在准备发送时的排队时间
    
    <br/>
+ 时延带宽积
+ 往返时间
  例如 客户端从发送数据到 服务端， 服务端收到后给客户端返回确认收到信息的时间
  
+ 利用率
  - 信道利用率
    信道利用率是指 单位时间内，有百分之几的时间是有被利用的(有数据通过)
    该值越低越好，如果该值过高，就类似于生活中堵车的场景，行车的时间就会变长
    
  - 网络利用率
    网络利用率是指，全网络的 信道利用率 的加权平均值
  
  信道利用率 和 网络利用率 变高了会增加网络的时延
  网络利用率达到50%，网络的时延就会翻倍，当达到100%，网络的时延就相当于是无穷大

  所以一些拥有主干网的 isp 都会控制 通道利用率不超过 50% 超过了就会准备扩容，增加线路的带宽

<br/>

### 计算机网络的非性能指标

+ 费用
+ 质量
+ 标准化
+ 可靠性
+ 可扩展性和可升级性
+ 易于管理和维护

## 计算机网络的体系架构
### 计算机网络体系架构的形成

计算机网络是个非常复杂的系统，可以设想一下，要想使网络中的两台计算机互相发送文件，除了建立一条两台计算机的线路，我们可能还需要考虑如下


> (1) 发起通信的计算机必须将数据通信的通路进行激活(activate)。所谓“激活”就是要发出一些信令,保证要传送的计算机数据能在这条通路上正确发送和接收。
>
> (2) 要告诉网络如何识别接收数据的计算机。
>
> (3) 发起通信的计算机必须查明对方计算机是否已开机,并且与网络连接正常。
>
> (4) 发起通信的计算机中的应用程序必须弄清楚,在对方计算机中的文件管理程序是否已做好接收文件和存储文件的准备工作。
>
> (5) 若计算机的文件格式不兼容,则至少其中一台计算机应完成格式转换功能。
>
> (6) 对出现的各种差错和意外事故,如数据传送错误、重复或丢失,网络中某个结点交换机出现故障等,应当有可靠的措施保证对方计算机最终能够收到正确的文件。

由此可见，计算机网络通信的必须高度高度协调才行，而高度协调是极其复杂的，为了设计出这样的计算机网络，就有了 <b>分层</b> 的概念被提出，<b>分层</b> 可以使庞大而复杂的问题，转换成若干个局部问题。

1974 年，美国 IBM 公司宣布了<b>系统网络体系架构 SNA(System Network Architecture)</b>，这个著名的网络体系架构就是按照分层的架构设计的，现在用 IBM 大型架构建的项目仍是使用 SNA，不久后，其它公司相继提出了不同名称的网络体系架构。

这种情况出现后，采用相同公司生成的设备能够很轻松的互连成网，这很容易形成垄断，而因为不同公司使用的体系架构不同，很显然，是不能够相互连接的。

而为了解决这个问题，国际标准化网络组织 ISO 在 1977 年成立的专门的机构研究该问题，他们提出了一个试图使全世界计算机可以互相连网的标准架构，即著名的 <b>开放系统互连基本参考模型 OSI/RM (Open System Interconnection Refercence Model)</b>，简称 `OSI`，只要遵循这个标准，就可以和世界上其它任何同样遵循该标准的网络设备进行通信，`OSI` 只是一个抽象的概念。

在 1983 年形成了正式的 开放系统互连基本参考模型的正式文件，即著名的 `OIS 7498` 国际标准，也就是所谓的 OSI 模型七层协议的体系架构

`OSI` 试图达到一种理想的状态，即全球的计算机都遵循这个统一标准，这样所有的计算机都都可以互连且进行数据交换，在 20 世纪 80 年代，很多大公司甚至一些国家的政府机构都纷纷表示支持 `OSI`, 但是到了 20 世纪 90 年代，虽然 整套的 `OSI` 国际标准都已经制定出来了，但是基于 `TPC/IP` 协议的互联网已经抢先获得了成功，此时几乎已经找不到生产符合 `OSI` 国际标准的设备了。
因此，人们获得了一个结论，即 `OSI` 只获得了一些理论的研究成果，但在市场方面却事与愿违的失败了，现今规模最大的，覆盖全球的，基于 `TCP/IP` 协议的互联网并未使用 `OSI` 标准， `OSI` 模型失败的几个原因如下
+ `OSI` 专家缺少经验，在完成 `OSI` 标准时缺乏商业驱动力
+ `OSI` 标准制定的时间过长
+ `OSI` 标准太过于复杂，而且运行效率低
+ `OSI` 标准层次划分过多，有些功能在不同层中重复使用

<!-- 而后，虽然 OSI 是国际认可的网络标准，但是基于 TCP/IP 协议的互联网成为了人们的 -->


<!-- 
## 总结

报文交换和分组交换不需要预先分配传输带宽，在传送突发数据时可以提高整个网络的信道利用率

- 广域网 WAN 花钱买带宽，运营商维护
- 城域网 MAN
- 局域网 LAN 个人维护
- 个人区域网 PAN

- 速率
- 带宽
  比如 100mbit 表示发送数据 100， 接收数据也是 100
  最高速率 网卡或交换机每秒能传输最大的数据 比特
- 吞吐量
  1 字节 = 8 比特

  7MB/秒

- 时延
  发送时延 4
  从数据最后 1 比特从网卡发送出去

  传播时延
  从数据最后 1 比特从网卡发送出去
  到最后 1 比特进入到路由器缓存
  处理时延
  排队时延

- 往返时间 RTT
  使用卫星通信，往返时间 rtt 相对较长
  可以使用 ping 命令来查看

- 利用率
  - 信道利用率
    信道利用率并非越高越好，该信道的时延也就迅速增加
  - 网路利用率

计算机网络非性能特征

- 费用
- 质量
- 标准化
- 可靠性
- 可扩展性和可升级型
- 易于管理和维护

## 计算机网络体系结构的形成

计算机网络是个非常复杂的系统
‘分层‘ 将庞大而复杂的问题转换成若干个较小的局部问题

1974 年 IBM 系统网络体系结构 SNA
其它公司相应提出

国际标准化组织 ISO 提出了 开发系统互连基本参考模型 osi/rm
例如两个省的铁路 轨道宽度

获得了理论研究成果，在市场化方面失败了，没有利益驱动
实现过分复杂，运行效率低

- osi 的专家们在完成 osi 标准时没有商业驱动力
- osi 协议实现过分复杂，且执行效率很低
- osi 标准制定周期过长，因而使得 osi 标准生成的设备无法及时进入市场
- osi 的层次划分不太合理，有些功能在多个层次充重复出现

## 国际上的两种标准

当前 OSI
非国际标准 TCP/IP 获得了最广泛的引用

### 协议与划分层次

《对等实体》
数据交换必须遵守事先约定好的规则
这些规则 规定了所交换的数据格式及其有关的同步问题（同步含有时序问题）
网络协议三要素
语法：什么地方需要填什么内容
语义：类似于传参
同步：事件实现顺序的说明

wireshark 抓包工具

应用层协议
http 协议
smtp 协议
dns 协议
FTP 协议

解决接收

### 传输层

为应用层 提供服务，提供可靠的传输，保证数据能够完整传输 tcp/ip 协议中 tcp 协议主要为我们提供了可靠的传输

传输层传输的 段

### 网络层

网络层是为传输层提供服务的
段 + 网络地址 = 数据包
网络中的路由器根据 ip 地址选择出口

### 数据链路层

加上 其它地址 目标 ip 目标 mac
传输协议是帧
给到路由器，去掉 数据链路层的数据，重新封装，然后再一层一层传输

分层好处
各层之间是独立的
结构上可分隔开
易于实现和维护

缺点
效率低

支持 ipv6 网络层和数据链路层支持就 ok

层数太多 会在描述
陈述太少 会使每一层协议太复杂

#### 各个层中完成的主要功能

差错控制： 使相应层次对等方的通行更加可靠 （数据链路层检查，网络层检查，传输层检查（TCP, 重传））
流量控制：发送端的发送速率必须使接收端来得及接收，不要太快 （传输层）
分段和重装：发送端将要发送的数据块划分为更小的单位，在接收端将其还原（传输层）类似于装箱拆箱的操作
复用和分佣：发送端几个高层会话复用同一条底层的连接，在接收端再进行分用，（传输层，网络层，数据链路层）
连接建立和释放：交换数据前先建立一条逻辑连接，数据传送结束后释放连接，（传输层）

osi 参考模型 7 层

- 应用层
- 表示层
- 会话层
- 传输层
- 网络层
- 数据链路层
- 物理层

TCP/IP 模型是四层

tcp/ip

- 应用层
  - 应用层
  - 表示层
  - 会话层
- 运输层
- 网络层
- 网络接口层
  - 没有具体内容

五层协议的体系结构

- 应用层
  - 应用层
  - 表示层
  - 会话层
- 运输层
- 网络层
- 数据链路层
- 物理层

TCP/IP 协议分层
应用层： HTTP FTP SMTP DNS POP3 等
传输层： `TCP` UDP
网络层： ARP `IP` ICMP IGMP
数据链路层：CSMA/CD PPP X.25 HDLC 帧中继  
(网络接口层) -->
